---
title: Calyx API
layout: page
---
<div id="content">
      <h1>Documentation by YARD 0.9.9</h1>
      <div id="readme">

<p># Calyx API</p>

<p>Just a placeholder to ensure clean API doc generation.</p>

</div>
<h1>Top Level Namespace



</h1>
<div class="box_info">











</div>

<h2>Defined Under Namespace</h2>
<p class="children">


      <strong class="modules">Modules:</strong> <span class="object_link"><a href="index.html" title="Calyx (module)">Calyx</a></span>




</p>










<h1>Module: Calyx



</h1>
<div class="box_info">











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/rule.rb<span class="defines">,<br>
  lib/calyx/errors.rb,<br> lib/calyx/format.rb,<br> lib/calyx/result.rb,<br> lib/calyx/grammar.rb,<br> lib/calyx/options.rb,<br> lib/calyx/version.rb,<br> lib/calyx/registry.rb,<br> lib/calyx/modifiers.rb,<br> lib/calyx/production/memo.rb,<br> lib/calyx/production/concat.rb,<br> lib/calyx/production/unique.rb,<br> lib/calyx/production/choices.rb,<br> lib/calyx/production/terminal.rb,<br> lib/calyx/production/expression.rb,<br> lib/calyx/production/non_terminal.rb,<br> lib/calyx/production/weighted_choices.rb</span>
</dd>
  </dl>

</div>

<h2>Defined Under Namespace</h2>
<p class="children">


      <strong class="modules">Modules:</strong> <span class="object_link"><a href="" title="Calyx::Errors (module)">Errors</a></span>, <span class="object_link"><a href="" title="Calyx::Format (module)">Format</a></span>, <span class="object_link"><a href="" title="Calyx::Production (module)">Production</a></span>



      <strong class="classes">Classes:</strong> <span class="object_link"><a href="" title="Calyx::Grammar (class)">Grammar</a></span>, <span class="object_link"><a href="" title="Calyx::Modifiers (class)">Modifiers</a></span>, <span class="object_link"><a href="" title="Calyx::Options (class)">Options</a></span>, <span class="object_link"><a href="" title="Calyx::Registry (class)">Registry</a></span>, <span class="object_link"><a href="" title="Calyx::Result (class)">Result</a></span>, <span class="object_link"><a href="" title="Calyx::Rule (class)">Rule</a></span>


</p>

  <h2>Constant Summary</h2>
  <dl class="constants">

      <dt id="VERSION-constant" class="">VERSION =

      </dt>
      <dd><pre class="code"><span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">0.17.0</span><span class="tstring_end">'</span></span><span class="period">.</span><span class="id identifier rubyid_freeze">freeze</span></pre></dd>

  </dl>










<h1>Module: Calyx::Errors



</h1>
<div class="box_info">











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/errors.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>Library-specific error types.</p>


  </div>
</div>
<div class="tags">


</div>
<h2>Defined Under Namespace</h2>
<p class="children">




      <strong class="classes">Classes:</strong> <span class="object_link"><a href="" title="Calyx::Errors::DuplicateRule (class)">DuplicateRule</a></span>, <span class="object_link"><a href="" title="Calyx::Errors::InvalidDefinition (class)">InvalidDefinition</a></span>, <span class="object_link"><a href="" title="Calyx::Errors::UndefinedRule (class)">UndefinedRule</a></span>, <span class="object_link"><a href="" title="Calyx::Errors::UnsupportedFormat (class)">UnsupportedFormat</a></span>


</p>










<h1>Module: Calyx::Format



</h1>
<div class="box_info">











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/format.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>Helper methods for loading and initializing grammars from static files on
disk.</p>


  </div>
</div>
<div class="tags">


</div>
<h2>Defined Under Namespace</h2>
<p class="children">




      <strong class="classes">Classes:</strong> <span class="object_link"><a href="" title="Calyx::Format::JSONGrammar (class)">JSONGrammar</a></span>, <span class="object_link"><a href="" title="Calyx::Format::Trace (class)">Trace</a></span>, <span class="object_link"><a href="" title="Calyx::Format::YAMLGrammar (class)">YAMLGrammar</a></span>


</p>








    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#load-class_method" title="load (class method)">.<strong>load</strong>(filename)  ⇒ Calyx::Grammar </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Reads a file and parses its format, based on the given extension.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#load_json-class_method" title="load_json (class method)">.<strong>load_json</strong>(filename)  ⇒ Calyx::Format::JSONGrammar </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Converts the given string of JSON data to a grammar instance.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#load_yml-class_method" title="load_yml (class method)">.<strong>load_yml</strong>(filename)  ⇒ Calyx::Format::YAMLGrammar </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Converts the given string of YAML data to a grammar instance.</p>
</div></span>

</li>


    </ul>




  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="load-class_method">

    .<strong>load</strong>(filename)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Grammar (class)">Calyx::Grammar</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Reads a file and parses its format, based on the given extension.</p>

<p>Accepts a JSON or YAML file path, identified by its extension (`.json` or
`.yml`).</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">filename</span>


        <span class="type">(<tt>String</tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Grammar (class)">Calyx::Grammar</a></span></tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


68
69
70
71
72
73
74
75
76
77
78</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/format.rb', line 68</span>

<span class="kw">def</span> <span class="kw">self</span><span class="period">.</span><span class="id identifier rubyid_load">load</span><span class="lparen">(</span><span class="id identifier rubyid_filename">filename</span><span class="rparen">)</span>
  <span class="id identifier rubyid_extension">extension</span> <span class="op">=</span> <span class="const">File</span><span class="period">.</span><span class="id identifier rubyid_extname">extname</span><span class="lparen">(</span><span class="id identifier rubyid_filename">filename</span><span class="rparen">)</span>

  <span class="kw">if</span> <span class="id identifier rubyid_extension">extension</span> <span class="op">==</span> <span class="tstring"><span class="tstring_beg">"</span><span class="tstring_content">.yml</span><span class="tstring_end">"</span></span>
    <span class="kw">self</span><span class="period">.</span><span class="id identifier rubyid_load_yml">load_yml</span><span class="lparen">(</span><span class="id identifier rubyid_filename">filename</span><span class="rparen">)</span>
  <span class="kw">elsif</span> <span class="id identifier rubyid_extension">extension</span> <span class="op">==</span> <span class="tstring"><span class="tstring_beg">"</span><span class="tstring_content">.json</span><span class="tstring_end">"</span></span>
    <span class="kw">self</span><span class="period">.</span><span class="id identifier rubyid_load_json">load_json</span><span class="lparen">(</span><span class="id identifier rubyid_filename">filename</span><span class="rparen">)</span>
  <span class="kw">else</span>
    <span class="id identifier rubyid_raise">raise</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Errors (module)">Errors</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="" title="Calyx::Errors::UnsupportedFormat (class)">UnsupportedFormat</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Errors::UnsupportedFormat#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_filename">filename</span><span class="rparen">)</span>
  <span class="kw">end</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="load_json-class_method">

    .<strong>load_json</strong>(filename)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Format::JSONGrammar (class)">Calyx::Format::JSONGrammar</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Converts the given string of JSON data to a grammar instance.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">filename</span>


        <span class="type">(<tt>String</tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Format::JSONGrammar (class)">Calyx::Format::JSONGrammar</a></span></tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92
93
94</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/format.rb', line 92</span>

<span class="kw">def</span> <span class="kw">self</span><span class="period">.</span><span class="id identifier rubyid_load_json">load_json</span><span class="lparen">(</span><span class="id identifier rubyid_filename">filename</span><span class="rparen">)</span>
  <span class="kw">self</span><span class="period">.</span><span class="id identifier rubyid_build_grammar">build_grammar</span><span class="lparen">(</span><span class="const"><span class="object_link"><a href="" title="Calyx::Format::JSONGrammar (class)">JSONGrammar</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Format::JSONGrammar#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_filename">filename</span><span class="rparen">)</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="load_yml-class_method">

    .<strong>load_yml</strong>(filename)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Format::YAMLGrammar (class)">Calyx::Format::YAMLGrammar</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Converts the given string of YAML data to a grammar instance.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">filename</span>


        <span class="type">(<tt>String</tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Format::YAMLGrammar (class)">Calyx::Format::YAMLGrammar</a></span></tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


84
85
86</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/format.rb', line 84</span>

<span class="kw">def</span> <span class="kw">self</span><span class="period">.</span><span class="id identifier rubyid_load_yml">load_yml</span><span class="lparen">(</span><span class="id identifier rubyid_filename">filename</span><span class="rparen">)</span>
  <span class="kw">self</span><span class="period">.</span><span class="id identifier rubyid_build_grammar">build_grammar</span><span class="lparen">(</span><span class="const"><span class="object_link"><a href="" title="Calyx::Format::YAMLGrammar (class)">YAMLGrammar</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Format::YAMLGrammar#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_filename">filename</span><span class="rparen">)</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Module: Calyx::Production



</h1>
<div class="box_info">











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/production/choices.rb<span class="defines">,<br>
  lib/calyx/production/memo.rb,<br> lib/calyx/production/concat.rb,<br> lib/calyx/production/unique.rb,<br> lib/calyx/production/terminal.rb,<br> lib/calyx/production/expression.rb,<br> lib/calyx/production/non_terminal.rb,<br> lib/calyx/production/weighted_choices.rb</span>
</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>A type of production rule representing a list of possible rules, one of
which will chosen each time the grammar runs.</p>


  </div>
</div>
<div class="tags">


</div>
<h2>Defined Under Namespace</h2>
<p class="children">




      <strong class="classes">Classes:</strong> <span class="object_link"><a href="" title="Calyx::Production::Choices (class)">Choices</a></span>, <span class="object_link"><a href="" title="Calyx::Production::Concat (class)">Concat</a></span>, <span class="object_link"><a href="" title="Calyx::Production::Expression (class)">Expression</a></span>, <span class="object_link"><a href="" title="Calyx::Production::Memo (class)">Memo</a></span>, <span class="object_link"><a href="" title="Calyx::Production::NonTerminal (class)">NonTerminal</a></span>, <span class="object_link"><a href="" title="Calyx::Production::Terminal (class)">Terminal</a></span>, <span class="object_link"><a href="" title="Calyx::Production::Unique (class)">Unique</a></span>, <span class="object_link"><a href="" title="Calyx::Production::WeightedChoices (class)">WeightedChoices</a></span>


</p>










<h1>Class: Calyx::Rule



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Rule</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/rule.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>Represents a named rule connected to a tree of productions that can be
evaluated and a trace which represents where the rule was declared.</p>


  </div>
</div>
<div class="tags">


</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small>
</h2>
  <ul class="summary">

      <li class="public ">
  <span class="summary_signature">

      <a href="#name-instance_method" title="#name (instance method)">#<strong>name</strong>  ⇒ Object </a>



  </span>




      <span class="note title readonly">readonly</span>









    <span class="summary_desc"><div class="inline">
<p>Returns the value of attribute name.</p>
</div></span>

</li>


      <li class="public ">
  <span class="summary_signature">

      <a href="#productions-instance_method" title="#productions (instance method)">#<strong>productions</strong>  ⇒ Object </a>



  </span>




      <span class="note title readonly">readonly</span>









    <span class="summary_desc"><div class="inline">
<p>Returns the value of attribute productions.</p>
</div></span>

</li>


      <li class="public ">
  <span class="summary_signature">

      <a href="#trace-instance_method" title="#trace (instance method)">#<strong>trace</strong>  ⇒ Object </a>



  </span>




      <span class="note title readonly">readonly</span>









    <span class="summary_desc"><div class="inline">
<p>Returns the value of attribute trace.</p>
</div></span>

</li>


  </ul>





    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#evaluate-instance_method" title="#evaluate (instance method)">#<strong>evaluate</strong>(options)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline"></div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(name, productions, trace)  ⇒ Rule </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>A new instance of Rule.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(name, productions, trace)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Rule (class)">Rule</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns a new instance of Rule</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


7
8
9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/rule.rb', line 7</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_productions">productions</span><span class="comma">,</span> <span class="id identifier rubyid_trace">trace</span><span class="rparen">)</span>
  <span class="ivar">@name</span> <span class="op">=</span> <span class="id identifier rubyid_name">name</span><span class="period">.</span><span class="id identifier rubyid_to_sym">to_sym</span>
  <span class="ivar">@productions</span> <span class="op">=</span> <span class="id identifier rubyid_productions">productions</span>
  <span class="ivar">@trace</span> <span class="op">=</span> <span class="id identifier rubyid_trace">trace</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>


      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="name-instance_method">

    #<strong>name</strong>  ⇒ <tt>Object</tt>  <span class="extras">(readonly)</span>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns the value of attribute name</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/rule.rb', line 5</span>

<span class="kw">def</span> <span class="id identifier rubyid_name">name</span>
  <span class="ivar">@name</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>


      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="productions-instance_method">

    #<strong>productions</strong>  ⇒ <tt>Object</tt>  <span class="extras">(readonly)</span>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns the value of attribute productions</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/rule.rb', line 5</span>

<span class="kw">def</span> <span class="id identifier rubyid_productions">productions</span>
  <span class="ivar">@productions</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>


      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="trace-instance_method">

    #<strong>trace</strong>  ⇒ <tt>Object</tt>  <span class="extras">(readonly)</span>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns the value of attribute trace</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/rule.rb', line 5</span>

<span class="kw">def</span> <span class="id identifier rubyid_trace">trace</span>
  <span class="ivar">@trace</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="evaluate-instance_method">

    #<strong>evaluate</strong>(options)  ⇒ <tt>Object</tt>





</h3>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


13
14
15</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/rule.rb', line 13</span>

<span class="kw">def</span> <span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span>
  <span class="id identifier rubyid_productions">productions</span><span class="period">.</span><span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Exception: Calyx::Errors::UndefinedRule



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">RuntimeError</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">RuntimeError</li>

            <li class="next">Calyx::Errors::UndefinedRule</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/errors.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>Only rules that exist in the registry can be evaluated. When a non-existent
rule is referenced, this error is raised.</p>

<pre class="code ruby"><code class="ruby"><span class="id identifier rubyid_grammar">grammar</span> <span class="op">=</span> <span class="const"><span class="object_link"><a href="" title="Calyx (module)">Calyx</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="" title="Calyx::Grammar (class)">Grammar</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Grammar#initialize (method)">new</a></span></span> <span class="kw">do</span>
  <span class="id identifier rubyid_start">start</span> <span class="symbol">:blank</span>
<span class="kw">end</span>

<span class="id identifier rubyid_grammar">grammar</span><span class="period">.</span><span class="id identifier rubyid_evaluate">evaluate</span>
<span class="comment"># =&gt; Calyx::Errors::UndefinedRule: :blank is not defined
</span></code></pre>


  </div>
</div>
<div class="tags">


</div>







    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(rule, symbol)  ⇒ UndefinedRule </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>A new instance of UndefinedRule.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#source_line-instance_method" title="#source_line (instance method)">#<strong>source_line</strong>  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline"></div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#trace_api_boundary-instance_method" title="#trace_api_boundary (instance method)">#<strong>trace_api_boundary</strong>(trace)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline"></div></span>

</li>


    </ul>



  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(rule, symbol)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Errors::UndefinedRule (class)">UndefinedRule</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns a new instance of UndefinedRule</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


14
15
16
17
18
19
20
21
22</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/errors.rb', line 14</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_rule">rule</span><span class="comma">,</span> <span class="id identifier rubyid_symbol">symbol</span><span class="rparen">)</span>
  <span class="ivar">@trace</span> <span class="op">=</span> <span class="kw">if</span> <span class="id identifier rubyid_rule">rule</span>
    <span class="id identifier rubyid_rule">rule</span><span class="period">.</span><span class="id identifier rubyid_trace">trace</span>
  <span class="kw">else</span>
    <span class="id identifier rubyid_trace_api_boundary">trace_api_boundary</span><span class="lparen">(</span><span class="id identifier rubyid_caller_locations">caller_locations</span><span class="rparen">)</span>
  <span class="kw">end</span>

  <span class="kw">super</span><span class="lparen">(</span><span class="tstring"><span class="tstring_beg">"</span><span class="tstring_content">undefined rule :</span><span class="embexpr_beg">#{</span><span class="id identifier rubyid_symbol">symbol</span><span class="embexpr_end">}</span><span class="tstring_content"> in </span><span class="embexpr_beg">#{</span><span class="ivar">@trace</span><span class="period">.</span><span class="id identifier rubyid_path">path</span><span class="embexpr_end">}</span><span class="tstring_content">:</span><span class="embexpr_beg">#{</span><span class="ivar">@trace</span><span class="period">.</span><span class="id identifier rubyid_lineno">lineno</span><span class="embexpr_end">}</span><span class="tstring_content">:`</span><span class="embexpr_beg">#{</span><span class="id identifier rubyid_source_line">source_line</span><span class="embexpr_end">}</span><span class="tstring_content">`</span><span class="tstring_end">"</span></span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="source_line-instance_method">

    #<strong>source_line</strong>  ⇒ <tt>Object</tt>





</h3>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34
35
36
37</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/errors.rb', line 32</span>

<span class="kw">def</span> <span class="id identifier rubyid_source_line">source_line</span>
  <span class="const">File</span><span class="period">.</span><span class="id identifier rubyid_open">open</span><span class="lparen">(</span><span class="ivar">@trace</span><span class="period">.</span><span class="id identifier rubyid_absolute_path">absolute_path</span><span class="rparen">)</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_source">source</span><span class="op">|</span>
    <span class="lparen">(</span><span class="ivar">@trace</span><span class="period">.</span><span class="id identifier rubyid_lineno">lineno</span><span class="op">-</span><span class="int">1</span><span class="rparen">)</span><span class="period">.</span><span class="id identifier rubyid_times">times</span> <span class="lbrace">{</span> <span class="id identifier rubyid_source">source</span><span class="period">.</span><span class="id identifier rubyid_gets">gets</span> <span class="rbrace">}</span>
    <span class="id identifier rubyid_source">source</span><span class="period">.</span><span class="id identifier rubyid_gets">gets</span>
  <span class="kw">end</span><span class="period">.</span><span class="id identifier rubyid_strip">strip</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="trace_api_boundary-instance_method">

    #<strong>trace_api_boundary</strong>(trace)  ⇒ <tt>Object</tt>





</h3>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


24
25
26
27
28
29
30</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/errors.rb', line 24</span>

<span class="kw">def</span> <span class="id identifier rubyid_trace_api_boundary">trace_api_boundary</span><span class="lparen">(</span><span class="id identifier rubyid_trace">trace</span><span class="rparen">)</span>
  <span class="lparen">(</span><span class="id identifier rubyid_trace">trace</span><span class="period">.</span><span class="id identifier rubyid_count">count</span> <span class="op">-</span> <span class="int">1</span><span class="rparen">)</span><span class="period">.</span><span class="id identifier rubyid_downto">downto</span><span class="lparen">(</span><span class="int">0</span><span class="rparen">)</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_index">index</span><span class="op">|</span>
    <span class="kw">if</span> <span class="id identifier rubyid_trace">trace</span><span class="lbracket">[</span><span class="id identifier rubyid_index">index</span><span class="rbracket">]</span><span class="period">.</span><span class="id identifier rubyid_to_s">to_s</span><span class="period">.</span><span class="id identifier rubyid_include?">include?</span><span class="lparen">(</span><span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">lib/calyx/</span><span class="tstring_end">'</span></span><span class="rparen">)</span>
      <span class="kw">return</span> <span class="id identifier rubyid_trace">trace</span><span class="lbracket">[</span><span class="id identifier rubyid_index">index</span> <span class="op">+</span> <span class="int">1</span><span class="rbracket">]</span>
    <span class="kw">end</span>
  <span class="kw">end</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Exception: Calyx::Errors::DuplicateRule



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">ArgumentError</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">ArgumentError</li>

            <li class="next">Calyx::Errors::DuplicateRule</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/errors.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>Raised when a rule passed in via a context map conflicts with an existing
rule in the grammar.</p>

<pre class="code ruby"><code class="ruby"><span class="id identifier rubyid_grammar">grammar</span> <span class="op">=</span> <span class="const"><span class="object_link"><a href="" title="Calyx (module)">Calyx</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="" title="Calyx::Grammar (class)">Grammar</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Grammar#initialize (method)">new</a></span></span> <span class="kw">do</span>
  <span class="id identifier rubyid_start">start</span> <span class="symbol">:priority</span>
  <span class="id identifier rubyid_priority">priority</span> <span class="tstring"><span class="tstring_beg">"</span><span class="tstring_content">(A)</span><span class="tstring_end">"</span></span>
<span class="kw">end</span>

<span class="id identifier rubyid_grammar">grammar</span><span class="period">.</span><span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="label">priority:</span> <span class="tstring"><span class="tstring_beg">"</span><span class="tstring_content">(B)</span><span class="tstring_end">"</span></span><span class="rparen">)</span>
<span class="comment"># =&gt; Calyx::Errors::DuplicateRule: :priority is already registered
</span></code></pre>


  </div>
</div>
<div class="tags">


</div>







    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(msg)  ⇒ DuplicateRule </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>A new instance of DuplicateRule.</p>
</div></span>

</li>


    </ul>



  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(msg)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Errors::DuplicateRule (class)">DuplicateRule</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns a new instance of DuplicateRule</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


51
52
53</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/errors.rb', line 51</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_msg">msg</span><span class="rparen">)</span>
  <span class="kw">super</span><span class="lparen">(</span><span class="tstring"><span class="tstring_beg">"</span><span class="tstring_content">:</span><span class="embexpr_beg">#{</span><span class="id identifier rubyid_msg">msg</span><span class="embexpr_end">}</span><span class="tstring_content"> is already registered</span><span class="tstring_end">"</span></span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>



<h1>Exception: Calyx::Errors::UnsupportedFormat



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">ArgumentError</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">ArgumentError</li>

            <li class="next">Calyx::Errors::UnsupportedFormat</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/errors.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>Raised when the client attempts to load a grammar with an unsupported file
extension. Only `.json` and `.yml` are valid.</p>

<pre class="code ruby"><code class="ruby"><span class="const"><span class="object_link"><a href="" title="Calyx (module)">Calyx</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="" title="Calyx::Grammar (class)">Grammar</a></span></span><span class="period">.</span><span class="id identifier rubyid_load"><span class="object_link"><a href="#load-class_method" title="Calyx::Grammar.load (method)">load</a></span></span><span class="lparen">(</span><span class="tstring"><span class="tstring_beg">"</span><span class="tstring_content">grammar.toml</span><span class="tstring_end">"</span></span><span class="rparen">)</span>
<span class="comment"># =&gt; Calyx::Errors::UnsupportedFormat: grammar.toml is not a valid JSON or YAML file
</span></code></pre>


  </div>
</div>
<div class="tags">


</div>







    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(msg)  ⇒ UnsupportedFormat </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>A new instance of UnsupportedFormat.</p>
</div></span>

</li>


    </ul>



  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(msg)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Errors::UnsupportedFormat (class)">UnsupportedFormat</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns a new instance of UnsupportedFormat</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/errors.rb', line 62</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_msg">msg</span><span class="rparen">)</span>
  <span class="kw">super</span><span class="lparen">(</span><span class="tstring"><span class="tstring_beg">"</span><span class="embexpr_beg">#{</span><span class="const">File</span><span class="period">.</span><span class="id identifier rubyid_basename">basename</span><span class="lparen">(</span><span class="id identifier rubyid_msg">msg</span><span class="rparen">)</span><span class="embexpr_end">}</span><span class="tstring_content"> is not a valid JSON or YAML file</span><span class="tstring_end">"</span></span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>



<h1>Exception: Calyx::Errors::InvalidDefinition



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">ArgumentError</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">ArgumentError</li>

            <li class="next">Calyx::Errors::InvalidDefinition</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/errors.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>Raised when a rule defined in a grammar is invalid. This will prevent the
grammar from compiling correctly.</p>

<pre class="code ruby"><code class="ruby"><span class="const"><span class="object_link"><a href="" title="Calyx (module)">Calyx</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="" title="Calyx::Grammar (class)">Grammar</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Grammar#initialize (method)">new</a></span></span> <span class="kw">do</span>
  <span class="id identifier rubyid_start">start</span> <span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">40%</span><span class="tstring_end">'</span></span> <span class="op">=&gt;</span> <span class="float">0.4</span><span class="comma">,</span> <span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">30%</span><span class="tstring_end">'</span></span> <span class="op">=&gt;</span> <span class="float">0.3</span>
<span class="kw">end</span>

<span class="comment"># =&gt; Calyx::Errors::InvalidDefinition: Weights must sum to 1
</span></code></pre>


  </div>
</div>
<div class="tags">


</div>










<h1>Class: Calyx::Format::Trace



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Format::Trace</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/format.rb</dd>
  </dl>

</div>









    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#absolute_path-instance_method" title="#absolute_path (instance method)">#<strong>absolute_path</strong>  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline"></div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(match_symbol, filename, contents)  ⇒ Trace </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>A new instance of Trace.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#lineno-instance_method" title="#lineno (instance method)">#<strong>lineno</strong>  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline"></div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#path-instance_method" title="#path (instance method)">#<strong>path</strong>  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline"></div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(match_symbol, filename, contents)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Format::Trace (class)">Trace</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns a new instance of Trace</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


8
9
10
11
12</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/format.rb', line 8</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_match_symbol">match_symbol</span><span class="comma">,</span> <span class="id identifier rubyid_filename">filename</span><span class="comma">,</span> <span class="id identifier rubyid_contents">contents</span><span class="rparen">)</span>
  <span class="ivar">@match_symbol</span> <span class="op">=</span> <span class="id identifier rubyid_match_symbol">match_symbol</span>
  <span class="ivar">@filename</span> <span class="op">=</span> <span class="const">Pathname</span><span class="period">.</span><span class="id identifier rubyid_new">new</span><span class="lparen">(</span><span class="id identifier rubyid_filename">filename</span><span class="rparen">)</span>
  <span class="ivar">@contents</span> <span class="op">=</span> <span class="id identifier rubyid_contents">contents</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="absolute_path-instance_method">

    #<strong>absolute_path</strong>  ⇒ <tt>Object</tt>





</h3>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/format.rb', line 18</span>

<span class="kw">def</span> <span class="id identifier rubyid_absolute_path">absolute_path</span>
  <span class="ivar">@filename</span><span class="period">.</span><span class="id identifier rubyid_expand_path">expand_path</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="lineno-instance_method">

    #<strong>lineno</strong>  ⇒ <tt>Object</tt>





</h3>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


22
23
24
25
26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/format.rb', line 22</span>

<span class="kw">def</span> <span class="id identifier rubyid_lineno">lineno</span>
  <span class="id identifier rubyid_line_number">line_number</span> <span class="op">=</span> <span class="int">0</span>
  <span class="ivar">@contents</span><span class="period">.</span><span class="id identifier rubyid_each_line">each_line</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_line">line</span><span class="op">|</span>
    <span class="id identifier rubyid_line_number">line_number</span> <span class="op">+=</span> <span class="int">1</span>
    <span class="kw">return</span> <span class="id identifier rubyid_line_number">line_number</span> <span class="kw">if</span> <span class="id identifier rubyid_line">line</span> <span class="op">=~</span> <span class="ivar">@match_symbol</span>
  <span class="kw">end</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="path-instance_method">

    #<strong>path</strong>  ⇒ <tt>Object</tt>





</h3>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


14
15
16</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/format.rb', line 14</span>

<span class="kw">def</span> <span class="id identifier rubyid_path">path</span>
  <span class="ivar">@filename</span><span class="period">.</span><span class="id identifier rubyid_basename">basename</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Format::JSONGrammar



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Format::JSONGrammar</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/format.rb</dd>
  </dl>

</div>









    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#each_rule-instance_method" title="#each_rule (instance method)">#<strong>each_rule</strong>(&amp;block)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline"></div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(filename)  ⇒ JSONGrammar </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>A new instance of JSONGrammar.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(filename)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Format::JSONGrammar (class)">JSONGrammar</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns a new instance of JSONGrammar</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34
35
36
37</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/format.rb', line 32</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_filename">filename</span><span class="rparen">)</span>
  <span class="id identifier rubyid_require">require</span> <span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">json</span><span class="tstring_end">'</span></span>
  <span class="ivar">@filename</span> <span class="op">=</span> <span class="id identifier rubyid_filename">filename</span>
  <span class="ivar">@contents</span> <span class="op">=</span> <span class="const">File</span><span class="period">.</span><span class="id identifier rubyid_read">read</span><span class="lparen">(</span><span class="ivar">@filename</span><span class="rparen">)</span>
  <span class="ivar">@rules</span> <span class="op">=</span> <span class="const">JSON</span><span class="period">.</span><span class="id identifier rubyid_parse">parse</span><span class="lparen">(</span><span class="ivar">@contents</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="each_rule-instance_method">

    #<strong>each_rule</strong>(&amp;block)  ⇒ <tt>Object</tt>





</h3>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


39
40
41
42
43</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/format.rb', line 39</span>

<span class="kw">def</span> <span class="id identifier rubyid_each_rule">each_rule</span><span class="lparen">(</span><span class="op">&amp;</span><span class="id identifier rubyid_block">block</span><span class="rparen">)</span>
  <span class="ivar">@rules</span><span class="period">.</span><span class="id identifier rubyid_each">each</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_rule">rule</span><span class="comma">,</span> <span class="id identifier rubyid_productions">productions</span><span class="op">|</span>
    <span class="kw">yield</span> <span class="id identifier rubyid_rule">rule</span><span class="comma">,</span> <span class="id identifier rubyid_productions">productions</span><span class="comma">,</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Format::Trace (class)">Trace</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Format::Trace#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="tstring"><span class="regexp_beg">/</span><span class="tstring_content">("</span><span class="embexpr_beg">#{</span><span class="id identifier rubyid_rule">rule</span><span class="embexpr_end">}</span><span class="tstring_content">")(\s*)(:)</span><span class="regexp_end">/</span></span><span class="comma">,</span> <span class="ivar">@filename</span><span class="comma">,</span> <span class="ivar">@contents</span><span class="rparen">)</span>
  <span class="kw">end</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Format::YAMLGrammar



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Format::YAMLGrammar</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/format.rb</dd>
  </dl>

</div>









    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#each_rule-instance_method" title="#each_rule (instance method)">#<strong>each_rule</strong>(&amp;block)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline"></div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(filename)  ⇒ YAMLGrammar </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>A new instance of YAMLGrammar.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(filename)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Format::YAMLGrammar (class)">YAMLGrammar</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns a new instance of YAMLGrammar</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


47
48
49
50
51
52</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/format.rb', line 47</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_filename">filename</span><span class="rparen">)</span>
  <span class="id identifier rubyid_require">require</span> <span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">yaml</span><span class="tstring_end">'</span></span>
  <span class="ivar">@filename</span> <span class="op">=</span> <span class="id identifier rubyid_filename">filename</span>
  <span class="ivar">@contents</span> <span class="op">=</span> <span class="const">File</span><span class="period">.</span><span class="id identifier rubyid_read">read</span><span class="lparen">(</span><span class="ivar">@filename</span><span class="rparen">)</span>
  <span class="ivar">@rules</span> <span class="op">=</span> <span class="const">YAML</span><span class="period">.</span><span class="id identifier rubyid_load">load</span><span class="lparen">(</span><span class="ivar">@contents</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="each_rule-instance_method">

    #<strong>each_rule</strong>(&amp;block)  ⇒ <tt>Object</tt>





</h3>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


54
55
56
57
58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/format.rb', line 54</span>

<span class="kw">def</span> <span class="id identifier rubyid_each_rule">each_rule</span><span class="lparen">(</span><span class="op">&amp;</span><span class="id identifier rubyid_block">block</span><span class="rparen">)</span>
  <span class="ivar">@rules</span><span class="period">.</span><span class="id identifier rubyid_each">each</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_rule">rule</span><span class="comma">,</span> <span class="id identifier rubyid_productions">productions</span><span class="op">|</span>
    <span class="kw">yield</span> <span class="id identifier rubyid_rule">rule</span><span class="comma">,</span> <span class="id identifier rubyid_productions">productions</span><span class="comma">,</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Format::Trace (class)">Trace</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Format::Trace#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="tstring"><span class="regexp_beg">/</span><span class="embexpr_beg">#{</span><span class="id identifier rubyid_rule">rule</span><span class="embexpr_end">}</span><span class="tstring_content">:</span><span class="regexp_end">/</span></span><span class="comma">,</span> <span class="ivar">@filename</span><span class="comma">,</span> <span class="ivar">@contents</span><span class="rparen">)</span>
  <span class="kw">end</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Result



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Result</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/result.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>Value object representing a generated grammar result.</p>


  </div>
</div>
<div class="tags">


</div>







    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(expression)  ⇒ Result </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>A new instance of Result.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#symbol-instance_method" title="#symbol (instance method)">#<strong>symbol</strong>  ⇒ Symbol </a>



      (also: #to_sym)

  </span>









    <span class="summary_desc"><div class="inline">
<p>Produces a symbol as the output of the grammar.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#text-instance_method" title="#text (instance method)">#<strong>text</strong>  ⇒ String </a>



      (also: #to_s)

  </span>









    <span class="summary_desc"><div class="inline">
<p>Produces a text string as the output of the grammar.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#tree-instance_method" title="#tree (instance method)">#<strong>tree</strong>  ⇒ Array </a>



      (also: #to_exp)

  </span>









    <span class="summary_desc"><div class="inline">
<p>Produces a syntax tree of nested nodes as the output of the grammar.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(expression)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Result (class)">Result</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns a new instance of Result</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/result.rb', line 4</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_expression">expression</span><span class="rparen">)</span>
  <span class="ivar">@expression</span> <span class="op">=</span> <span class="id identifier rubyid_expression">expression</span><span class="period">.</span><span class="id identifier rubyid_freeze">freeze</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="symbol-instance_method">

    #<strong>symbol</strong>  ⇒ <tt>Symbol</tt>



    <span class="aliases">Also known as:
    <span class="names"><span id="to_sym-instance_method">to_sym</span></span>
    </span>



</h3>
<div class="docstring">
  <div class="discussion">

<p>Produces a symbol as the output of the grammar.</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


33
34
35</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/result.rb', line 33</span>

<span class="kw">def</span> <span class="id identifier rubyid_symbol">symbol</span>
  <span class="id identifier rubyid_text">text</span><span class="period">.</span><span class="id identifier rubyid_to_sym">to_sym</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="text-instance_method">

    #<strong>text</strong>  ⇒ <tt>String</tt>



    <span class="aliases">Also known as:
    <span class="names"><span id="to_s-instance_method">to_s</span></span>
    </span>



</h3>
<div class="docstring">
  <div class="discussion">

<p>Produces a text string as the output of the grammar.</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>String</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


22
23
24
25
26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/result.rb', line 22</span>

<span class="kw">def</span> <span class="id identifier rubyid_text">text</span>
  <span class="ivar">@expression</span><span class="period">.</span><span class="id identifier rubyid_flatten">flatten</span><span class="period">.</span><span class="id identifier rubyid_reject">reject</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_obj">obj</span><span class="op">|</span>
    <span class="id identifier rubyid_obj">obj</span><span class="period">.</span><span class="id identifier rubyid_is_a?">is_a?</span><span class="lparen">(</span><span class="const">Symbol</span><span class="rparen">)</span>
  <span class="kw">end</span><span class="period">.</span><span class="id identifier rubyid_join">join</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="tree-instance_method">

    #<strong>tree</strong>  ⇒ <tt>Array</tt>



    <span class="aliases">Also known as:
    <span class="names"><span id="to_exp-instance_method">to_exp</span></span>
    </span>



</h3>
<div class="docstring">
  <div class="discussion">

<p>Produces a syntax tree of nested nodes as the output of the grammar. Each
syntax node represents the production rules that were evaluated at each
step of the generator.</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


13
14
15</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/result.rb', line 13</span>

<span class="kw">def</span> <span class="id identifier rubyid_tree">tree</span>
  <span class="ivar">@expression</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Grammar



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Grammar</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/grammar.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>The main public interface to Calyx. Grammars represent the concept of a
template grammar defined by a set of production rules that can be chained
and nested from a given starting rule.</p>

<p>Calyx works like a traditional phrase-structured grammar in reverse.
Instead of recognising strings based on a union of possible matches, it
generates strings by representing the union as a choice and randomly
picking one of the options each time the grammar runs.</p>


  </div>
</div>
<div class="tags">


</div>







    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#filter-class_method" title="filter (class method)">.<strong>filter</strong>(name) {|the| ... } ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>DSL helper method for registering the given block as a string filter.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#inherit_registry-class_method" title="inherit_registry (class method)">.<strong>inherit_registry</strong>(child_registry)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Hook for combining the registry of a parent grammar into the child that
inherits from it.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#inherited-class_method" title="inherited (class method)">.<strong>inherited</strong>(subclass)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Hook for combining the rules from a parent grammar into the child that
inherits from it.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#load-class_method" title="load (class method)">.<strong>load</strong>(filename)  ⇒ Calyx::Grammar </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Load a grammar instance from the given file.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#mapping-class_method" title="mapping (class method)">.<strong>mapping</strong>(name, pairs)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>DSL helper method for registering a paired mapping regex.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#method_missing-class_method" title="method_missing (class method)">.<strong>method_missing</strong>(name, *productions)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Augument the grammar with a method missing hook that treats class method
calls as declarations of a new rule.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#modifier-class_method" title="modifier (class method)">.<strong>modifier</strong>(module_name)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>DSL helper method for registering a modifier module with the grammar.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#registry-class_method" title="registry (class method)">.<strong>registry</strong>  ⇒ Calyx::Registry </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Access the registry belonging to this grammar class.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#rule-class_method" title="rule (class method)">.<strong>rule</strong>(name, *productions)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>DSL helper method for registering a new grammar rule.</p>
</div></span>

</li>


    </ul>

    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public deprecated">
  <span class="summary_signature">

      <a href="#evaluate-instance_method" title="#evaluate (instance method)">#<strong>evaluate</strong>(*args)  ⇒ Object </a>



  </span>





  <span class="deprecated note title">deprecated</span>



    <span class="summary_desc"><strong>Deprecated.</strong> <div class="inline">
<p>Please use <span class="object_link"><a href="#generate_result-instance_method" title="Calyx::Grammar#generate_result (method)">#generate_result</a></span> instead.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#generate-instance_method" title="#generate (instance method)">#<strong>generate</strong>(*args)  ⇒ String </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Produces a string as an output of the grammar.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#generate_result-instance_method" title="#generate_result (instance method)">#<strong>generate_result</strong>(*args)  ⇒ Calyx::Result </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Produces a generated result from evaluating the grammar.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(options = {}, &amp;block)  ⇒ Grammar </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>Create a new grammar instance, passing in a random seed if needed.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(options = {}, &amp;block)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Grammar (class)">Grammar</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Create a new grammar instance, passing in a random seed if needed.</p>

<p>Grammar rules can be constructed on the fly when the passed-in block is
evaluated.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">options</span>


        <span class="type">(<tt>Numeric</tt>, <tt>Random</tt>, <tt>Hash</tt>)</span>


        <em class="default">(defaults to: <tt>{}</tt>)</em>


    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/grammar.rb', line 103</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="op">=</span><span class="lbrace">{</span><span class="rbrace">}</span><span class="comma">,</span> <span class="op">&amp;</span><span class="id identifier rubyid_block">block</span><span class="rparen">)</span>
  <span class="kw">unless</span> <span class="id identifier rubyid_options">options</span><span class="period">.</span><span class="id identifier rubyid_is_a?">is_a?</span><span class="lparen">(</span><span class="const">Hash</span><span class="rparen">)</span>
    <span class="id identifier rubyid_config_opts">config_opts</span> <span class="op">=</span> <span class="lbrace">{</span><span class="rbrace">}</span>
    <span class="kw">if</span> <span class="id identifier rubyid_options">options</span><span class="period">.</span><span class="id identifier rubyid_is_a?">is_a?</span><span class="lparen">(</span><span class="const">Numeric</span><span class="rparen">)</span>
      <span class="id identifier rubyid_warn">warn</span> <span class="lbracket">[</span>
        <span class="tstring"><span class="tstring_beg">"</span><span class="tstring_content">NOTE: Passing a numeric seed arg directly is deprecated. </span><span class="tstring_end">"</span></span><span class="comma">,</span>
        <span class="tstring"><span class="tstring_beg">"</span><span class="tstring_content">Use the options hash instead: `Calyx::Grammar.new(seed: 1234)`</span><span class="tstring_end">"</span></span>
      <span class="rbracket">]</span><span class="period">.</span><span class="id identifier rubyid_join">join</span>
      <span class="id identifier rubyid_config_opts">config_opts</span><span class="lbracket">[</span><span class="symbol">:seed</span><span class="rbracket">]</span> <span class="op">=</span> <span class="id identifier rubyid_options">options</span>
    <span class="kw">elsif</span> <span class="id identifier rubyid_options">options</span><span class="period">.</span><span class="id identifier rubyid_is_a?">is_a?</span><span class="lparen">(</span><span class="const">Random</span><span class="rparen">)</span>
      <span class="id identifier rubyid_warn">warn</span> <span class="lbracket">[</span>
        <span class="tstring"><span class="tstring_beg">"</span><span class="tstring_content">NOTE: Passing a Random object directly is deprecated. </span><span class="tstring_end">"</span></span><span class="comma">,</span>
        <span class="tstring"><span class="tstring_beg">"</span><span class="tstring_content">Use the options hash instead: `Calyx::Grammar.new(rng: Random.new)`</span><span class="tstring_end">"</span></span>
      <span class="rbracket">]</span><span class="period">.</span><span class="id identifier rubyid_join">join</span>
      <span class="id identifier rubyid_config_opts">config_opts</span><span class="lbracket">[</span><span class="symbol">:rng</span><span class="rbracket">]</span> <span class="op">=</span> <span class="id identifier rubyid_options">options</span>
    <span class="kw">end</span>
  <span class="kw">else</span>
    <span class="id identifier rubyid_config_opts">config_opts</span> <span class="op">=</span> <span class="id identifier rubyid_options">options</span>
  <span class="kw">end</span>

  <span class="ivar">@options</span> <span class="op">=</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Options (class)">Options</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Options#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_config_opts">config_opts</span><span class="rparen">)</span>

  <span class="kw">if</span> <span class="id identifier rubyid_block_given?">block_given?</span>
    <span class="ivar">@registry</span> <span class="op">=</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Registry (class)">Registry</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Registry#initialize (method)">new</a></span></span>
    <span class="ivar">@registry</span><span class="period">.</span><span class="id identifier rubyid_instance_eval">instance_eval</span><span class="lparen">(</span><span class="op">&amp;</span><span class="id identifier rubyid_block">block</span><span class="rparen">)</span>
  <span class="kw">else</span>
    <span class="ivar">@registry</span> <span class="op">=</span> <span class="kw">self</span><span class="period">.</span><span class="id identifier rubyid_class">class</span><span class="period">.</span><span class="id identifier rubyid_registry">registry</span>
  <span class="kw">end</span>

  <span class="ivar">@registry</span><span class="period">.</span><span class="id identifier rubyid_options">options</span><span class="lparen">(</span><span class="ivar">@options</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="filter-class_method">

    .<strong>filter</strong>(name) {|the| ... } ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>DSL helper method for registering the given block as a string filter.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">name</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

</ul>

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">

    <li>

        <span class="name">the</span>


        <span class="type">(<tt>String</tt>)</span>



        —
        <div class="inline">
<p>input string to be processed by the filter</p>
</div>

    </li>

</ul>
<p class="tag_title">Yield Returns:</p>
<ul class="yieldreturn">

    <li>


        <span class="type">(<tt>String</tt>)</span>



        —
        <div class="inline">
<p>the processed output string</p>
</div>

    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/grammar.rb', line 52</span>

<span class="kw">def</span> <span class="id identifier rubyid_filter">filter</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="op">&amp;</span><span class="id identifier rubyid_block">block</span><span class="rparen">)</span>
  <span class="id identifier rubyid_registry">registry</span><span class="period">.</span><span class="id identifier rubyid_filter">filter</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="op">&amp;</span><span class="id identifier rubyid_block">block</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="inherit_registry-class_method">

    .<strong>inherit_registry</strong>(child_registry)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Hook for combining the registry of a parent grammar into the child that
inherits from it.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">child_registry</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Registry (class)">Calyx::Registry</a></span></tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/grammar.rb', line 82</span>

<span class="kw">def</span> <span class="id identifier rubyid_inherit_registry">inherit_registry</span><span class="lparen">(</span><span class="id identifier rubyid_child_registry">child_registry</span><span class="rparen">)</span>
  <span class="id identifier rubyid_registry">registry</span><span class="period">.</span><span class="id identifier rubyid_combine">combine</span><span class="lparen">(</span><span class="id identifier rubyid_child_registry">child_registry</span><span class="rparen">)</span> <span class="kw">unless</span> <span class="id identifier rubyid_child_registry">child_registry</span><span class="period">.</span><span class="id identifier rubyid_nil?">nil?</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="inherited-class_method">

    .<strong>inherited</strong>(subclass)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Hook for combining the rules from a parent grammar into the child that
inherits from it.</p>

<p>This is automatically called by the Ruby engine.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">subclass</span>


        <span class="type">(<tt>Class</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92
93
94</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/grammar.rb', line 92</span>

<span class="kw">def</span> <span class="id identifier rubyid_inherited">inherited</span><span class="lparen">(</span><span class="id identifier rubyid_subclass">subclass</span><span class="rparen">)</span>
  <span class="id identifier rubyid_subclass">subclass</span><span class="period">.</span><span class="id identifier rubyid_inherit_registry">inherit_registry</span><span class="lparen">(</span><span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="load-class_method">

    .<strong>load</strong>(filename)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Grammar (class)">Calyx::Grammar</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Load a grammar instance from the given file.</p>

<p>Accepts a JSON or YAML file path, identified by its extension (`.json` or
`.yml`).</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">filename</span>


        <span class="type">(<tt>String</tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Grammar (class)">Calyx::Grammar</a></span></tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


28
29
30</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/grammar.rb', line 28</span>

<span class="kw">def</span> <span class="id identifier rubyid_load">load</span><span class="lparen">(</span><span class="id identifier rubyid_filename">filename</span><span class="rparen">)</span>
  <span class="const"><span class="object_link"><a href="" title="Calyx::Format (module)">Format</a></span></span><span class="period">.</span><span class="id identifier rubyid_load"><span class="object_link"><a href="#load-class_method" title="Calyx::Format.load (method)">load</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_filename">filename</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="mapping-class_method">

    .<strong>mapping</strong>(name, pairs)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>DSL helper method for registering a paired mapping regex.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">name</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">pairs</span>


        <span class="type">(<tt>Hash&lt;Regex,String&gt;</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/grammar.rb', line 43</span>

<span class="kw">def</span> <span class="id identifier rubyid_mapping">mapping</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_pairs">pairs</span><span class="rparen">)</span>
  <span class="id identifier rubyid_registry">registry</span><span class="period">.</span><span class="id identifier rubyid_mapping">mapping</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_pairs">pairs</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="method_missing-class_method">

    .<strong>method_missing</strong>(name, *productions)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Augument the grammar with a method missing hook that treats class method
calls as declarations of a new rule.</p>

<p>This must be bypassed by calling `#rule` directly if the name of the
desired rule clashes with an existing helper method.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">name</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">productions</span>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/grammar.rb', line 74</span>

<span class="kw">def</span> <span class="id identifier rubyid_method_missing">method_missing</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="op">*</span><span class="id identifier rubyid_productions">productions</span><span class="rparen">)</span>
  <span class="id identifier rubyid_registry">registry</span><span class="period">.</span><span class="id identifier rubyid_define_rule">define_rule</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_caller_locations">caller_locations</span><span class="period">.</span><span class="id identifier rubyid_first">first</span><span class="comma">,</span> <span class="id identifier rubyid_productions">productions</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="modifier-class_method">

    .<strong>modifier</strong>(module_name)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>DSL helper method for registering a modifier module with the grammar.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">module_name</span>


        <span class="type">(<tt>Module</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36
37</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/grammar.rb', line 35</span>

<span class="kw">def</span> <span class="id identifier rubyid_modifier">modifier</span><span class="lparen">(</span><span class="id identifier rubyid_module_name">module_name</span><span class="rparen">)</span>
  <span class="id identifier rubyid_registry">registry</span><span class="period">.</span><span class="id identifier rubyid_modifier">modifier</span><span class="lparen">(</span><span class="id identifier rubyid_module_name">module_name</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="registry-class_method">

    .<strong>registry</strong>  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Registry (class)">Calyx::Registry</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Access the registry belonging to this grammar class.</p>

<p>Constructs a new registry if it isn't already available.</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Registry (class)">Calyx::Registry</a></span></tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/grammar.rb', line 17</span>

<span class="kw">def</span> <span class="id identifier rubyid_registry">registry</span>
  <span class="ivar">@registry</span> <span class="op">||=</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Registry (class)">Registry</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Registry#initialize (method)">new</a></span></span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="rule-class_method">

    .<strong>rule</strong>(name, *productions)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>DSL helper method for registering a new grammar rule.</p>

<p>Not usually used directly, as the method missing API is less verbose.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">name</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">productions</span>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/grammar.rb', line 62</span>

<span class="kw">def</span> <span class="id identifier rubyid_rule">rule</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="op">*</span><span class="id identifier rubyid_productions">productions</span><span class="rparen">)</span>
  <span class="id identifier rubyid_registry">registry</span><span class="period">.</span><span class="id identifier rubyid_define_rule">define_rule</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_caller_locations">caller_locations</span><span class="period">.</span><span class="id identifier rubyid_first">first</span><span class="comma">,</span> <span class="id identifier rubyid_productions">productions</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="evaluate-instance_method">

    #<strong>evaluate</strong>(*args)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">
    <div class="note deprecated">
<strong>Deprecated.</strong> <div class="inline">
<p>Please use <span class="object_link"><a href="#generate_result-instance_method" title="Calyx::Grammar#generate_result (method)">#generate_result</a></span> instead.</p>
</div>
</div>

<p>Produces a syntax tree of nested list nodes as an output of the grammar.</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


149
150
151
152
153
154
155
156
157
158</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/grammar.rb', line 149</span>

<span class="kw">def</span> <span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="op">*</span><span class="id identifier rubyid_args">args</span><span class="rparen">)</span>
  <span class="id identifier rubyid_warn">warn</span> <span class="heredoc_beg">&lt;&lt;~DEPRECATION</span>
<span class="tstring_content">    [DEPRECATION] `evaluate` is deprecated and will be removed in 1.0.
</span><span class="tstring_content">    Please use #generate_result instead.
</span><span class="tstring_content">    See https://github.com/maetl/calyx/issues/23 for more details.
</span><span class="heredoc_end">  DEPRECATION
</span>
  <span class="id identifier rubyid_result">result</span> <span class="op">=</span> <span class="id identifier rubyid_generate_result">generate_result</span><span class="lparen">(</span><span class="op">*</span><span class="id identifier rubyid_args">args</span><span class="rparen">)</span>
  <span class="id identifier rubyid_result">result</span><span class="period">.</span><span class="id identifier rubyid_tree">tree</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="generate-instance_method">

    #<strong>generate</strong>(*args)  ⇒ <tt>String</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Produces a string as an output of the grammar.</p>


  </div>
</div>
<div class="tags">

  <div class="docstring">
  <div class="discussion">


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">start_symbol</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">rules_map</span>


        <span class="type">(<tt>Hash</tt>)</span>



    </li>

</ul>


</div>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>String</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


141
142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/grammar.rb', line 141</span>

<span class="kw">def</span> <span class="id identifier rubyid_generate">generate</span><span class="lparen">(</span><span class="op">*</span><span class="id identifier rubyid_args">args</span><span class="rparen">)</span>
  <span class="id identifier rubyid_result">result</span> <span class="op">=</span> <span class="id identifier rubyid_generate_result">generate_result</span><span class="lparen">(</span><span class="op">*</span><span class="id identifier rubyid_args">args</span><span class="rparen">)</span>
  <span class="id identifier rubyid_result">result</span><span class="period">.</span><span class="id identifier rubyid_text">text</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="generate_result-instance_method">

    #<strong>generate_result</strong>(*args)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Result (class)">Calyx::Result</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Produces a generated result from evaluating the grammar.</p>


  </div>
</div>
<div class="tags">

  <div class="docstring">
  <div class="discussion">


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">start_symbol</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">rules_map</span>


        <span class="type">(<tt>Hash</tt>)</span>



    </li>

</ul>


</div>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Result (class)">Calyx::Result</a></span></tt>)</span>



    </li>

</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">

      <li><span class="object_link"><a href="" title="Calyx::Result (class)">Result</a></span></li>

  </ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


167
168
169
170
171</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/grammar.rb', line 167</span>

<span class="kw">def</span> <span class="id identifier rubyid_generate_result">generate_result</span><span class="lparen">(</span><span class="op">*</span><span class="id identifier rubyid_args">args</span><span class="rparen">)</span>
  <span class="id identifier rubyid_start_symbol">start_symbol</span><span class="comma">,</span> <span class="id identifier rubyid_rules_map">rules_map</span> <span class="op">=</span> <span class="id identifier rubyid_map_default_args">map_default_args</span><span class="lparen">(</span><span class="op">*</span><span class="id identifier rubyid_args">args</span><span class="rparen">)</span>

  <span class="const"><span class="object_link"><a href="" title="Calyx::Result (class)">Result</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Result#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="ivar">@registry</span><span class="period">.</span><span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_start_symbol">start_symbol</span><span class="comma">,</span> <span class="id identifier rubyid_rules_map">rules_map</span><span class="rparen">)</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Options



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Options</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/options.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>Provides access to configuration options while evaluating a grammar.</p>


  </div>
</div>
<div class="tags">


</div>
  <h2>Constant Summary</h2>
  <dl class="constants">

      <dt id="DEFAULTS-constant" class="">DEFAULTS =
        <div class="docstring">
  <div class="discussion">

<p>These options are used by default if not explicitly provided during
initialization of the grammar.</p>


  </div>
</div>
<div class="tags">


</div>
      </dt>
      <dd><pre class="code"><span class="lbrace">{</span>
  <span class="label">strict:</span> <span class="kw">true</span>
<span class="rbrace">}</span></pre></dd>

  </dl>








    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(options = {})  ⇒ Options </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>Constructs a new options instance, merging the passed in options with the
defaults.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#merge-instance_method" title="#merge (instance method)">#<strong>merge</strong>(options)  ⇒ Calyx::Options </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Merges two instances together and returns a new instance.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#rand-instance_method" title="#rand (instance method)">#<strong>rand</strong>  ⇒ Float </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Returns the next pseudo-random number in the sequence defined by the
internal random number generator state.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#rng-instance_method" title="#rng (instance method)">#<strong>rng</strong>  ⇒ Random </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Returns the internal random number generator instance.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#strict%3F-instance_method" title="#strict? (instance method)">#<strong>strict?</strong>  ⇒ TrueClass, FalseClass </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>True if the strict mode option is enabled.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#to_h-instance_method" title="#to_h (instance method)">#<strong>to_h</strong>  ⇒ Hash </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Serializes instance data to a hash.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(options = {})  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Options (class)">Options</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Constructs a new options instance, merging the passed in options with the
defaults.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">options</span>


        <span class="type">(<tt>Hash</tt>, <tt><span class="object_link"><a href="" title="Calyx::Options (class)">Calyx::Options</a></span></tt>)</span>


        <em class="default">(defaults to: <tt>{}</tt>)</em>


    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


14
15
16</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/options.rb', line 14</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="op">=</span><span class="lbrace">{</span><span class="rbrace">}</span><span class="rparen">)</span>
  <span class="ivar">@options</span> <span class="op">=</span> <span class="const"><span class="object_link"><a href="#DEFAULTS-constant" title="Calyx::Options::DEFAULTS (constant)">DEFAULTS</a></span></span><span class="period">.</span><span class="id identifier rubyid_merge"><span class="object_link"><a href="#merge-instance_method" title="Calyx::Options#merge (method)">merge</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="merge-instance_method">

    #<strong>merge</strong>(options)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Options (class)">Calyx::Options</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Merges two instances together and returns a new instance.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">options</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Options (class)">Calyx::Options</a></span></tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Options (class)">Calyx::Options</a></span></tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/options.rb', line 59</span>

<span class="kw">def</span> <span class="id identifier rubyid_merge">merge</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span>
  <span class="const"><span class="object_link"><a href="" title="Calyx::Options (class)">Options</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Options#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="ivar">@options</span><span class="period">.</span><span class="id identifier rubyid_merge">merge</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="period">.</span><span class="id identifier rubyid_to_h">to_h</span><span class="rparen">)</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="rand-instance_method">

    #<strong>rand</strong>  ⇒ <tt>Float</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns the next pseudo-random number in the sequence defined by the
internal random number generator state.</p>

<p>The value returned is a floating point number between 0.0 and 1.0,
including 0.0 and excluding 1.0.</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>Float</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


42
43
44</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/options.rb', line 42</span>

<span class="kw">def</span> <span class="id identifier rubyid_rand">rand</span>
  <span class="id identifier rubyid_rng">rng</span><span class="period">.</span><span class="id identifier rubyid_rand">rand</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="rng-instance_method">

    #<strong>rng</strong>  ⇒ <tt>Random</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns the internal random number generator instance. If a seed or random
instance is not passed-in directly, a new instance of `Random` is
initialized by default.</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>Random</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


23
24
25
26
27
28
29
30
31
32
33</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/options.rb', line 23</span>

<span class="kw">def</span> <span class="id identifier rubyid_rng">rng</span>
  <span class="kw">unless</span> <span class="ivar">@options</span><span class="lbracket">[</span><span class="symbol">:rng</span><span class="rbracket">]</span>
    <span class="ivar">@options</span><span class="lbracket">[</span><span class="symbol">:rng</span><span class="rbracket">]</span> <span class="op">=</span> <span class="kw">if</span> <span class="ivar">@options</span><span class="lbracket">[</span><span class="symbol">:seed</span><span class="rbracket">]</span>
      <span class="const">Random</span><span class="period">.</span><span class="id identifier rubyid_new">new</span><span class="lparen">(</span><span class="ivar">@options</span><span class="lbracket">[</span><span class="symbol">:seed</span><span class="rbracket">]</span><span class="rparen">)</span>
    <span class="kw">else</span>
      <span class="const">Random</span><span class="period">.</span><span class="id identifier rubyid_new">new</span>
    <span class="kw">end</span>
  <span class="kw">end</span>

  <span class="ivar">@options</span><span class="lbracket">[</span><span class="symbol">:rng</span><span class="rbracket">]</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="strict?-instance_method">

    #<strong>strict?</strong>  ⇒ <tt>TrueClass</tt>, <tt>FalseClass</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>True if the strict mode option is enabled. This option defines whether or
not to raise an error on missing rules. When set to false, missing rules
are skipped over when the production is concatenated.</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>TrueClass</tt>, <tt>FalseClass</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


51
52
53</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/options.rb', line 51</span>

<span class="kw">def</span> <span class="id identifier rubyid_strict?">strict?</span>
  <span class="ivar">@options</span><span class="lbracket">[</span><span class="symbol">:strict</span><span class="rbracket">]</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="to_h-instance_method">

    #<strong>to_h</strong>  ⇒ <tt>Hash</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Serializes instance data to a hash.</p>


  </div>
</div>
<div class="tags">

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>Hash</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


66
67
68</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/options.rb', line 66</span>

<span class="kw">def</span> <span class="id identifier rubyid_to_h">to_h</span>
  <span class="ivar">@options</span><span class="period">.</span><span class="id identifier rubyid_dup">dup</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Registry



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Registry</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/registry.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>Lookup table of all the available rules in the grammar.</p>


  </div>
</div>
<div class="tags">


</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small>
</h2>
  <ul class="summary">

      <li class="public ">
  <span class="summary_signature">

      <a href="#modifiers-instance_method" title="#modifiers (instance method)">#<strong>modifiers</strong>  ⇒ Object </a>



  </span>




      <span class="note title readonly">readonly</span>









    <span class="summary_desc"><div class="inline">
<p>Returns the value of attribute modifiers.</p>
</div></span>

</li>


      <li class="public ">
  <span class="summary_signature">

      <a href="#rules-instance_method" title="#rules (instance method)">#<strong>rules</strong>  ⇒ Object </a>



  </span>




      <span class="note title readonly">readonly</span>









    <span class="summary_desc"><div class="inline">
<p>Returns the value of attribute rules.</p>
</div></span>

</li>


      <li class="public ">
  <span class="summary_signature">

      <a href="#transforms-instance_method" title="#transforms (instance method)">#<strong>transforms</strong>  ⇒ Object </a>



  </span>




      <span class="note title readonly">readonly</span>









    <span class="summary_desc"><div class="inline">
<p>Returns the value of attribute transforms.</p>
</div></span>

</li>


  </ul>





    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#combine-instance_method" title="#combine (instance method)">#<strong>combine</strong>(registry)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Merges the given registry instance with the target registry.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#define_context_rule-instance_method" title="#define_context_rule (instance method)">#<strong>define_context_rule</strong>(name, trace, productions)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Defines a rule in the temporary evaluation context.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#define_rule-instance_method" title="#define_rule (instance method)">#<strong>define_rule</strong>(name, trace, productions)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Defines a static rule in the grammar.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#evaluate-instance_method" title="#evaluate (instance method)">#<strong>evaluate</strong>(start_symbol = :start, rules_map = {})  ⇒ Array </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Evaluates the grammar defined in this registry, combining it with rules
from the passed in context.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#expand-instance_method" title="#expand (instance method)">#<strong>expand</strong>(symbol)  ⇒ Calyx::Rule </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Expands the given symbol to its rule.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#filter-instance_method" title="#filter (instance method)">#<strong>filter</strong>(name, callable = nil) {|String| ... } ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Registers the given block as a string filter.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>  ⇒ Registry </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>Construct an empty registry.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#mapping-instance_method" title="#mapping (instance method)">#<strong>mapping</strong>(name, pairs)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Registers a paired mapping regex.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#memoize_expansion-instance_method" title="#memoize_expansion (instance method)">#<strong>memoize_expansion</strong>(symbol)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Expands a memoized rule symbol by evaluating it and storing the result for
later.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#method_missing-instance_method" title="#method_missing (instance method)">#<strong>method_missing</strong>(name, *productions)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Registers a new grammar rule without explicitly calling the `#rule` method.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#modifier-instance_method" title="#modifier (instance method)">#<strong>modifier</strong>(name)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Attaches a modifier module to this instance.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#options-instance_method" title="#options (instance method)">#<strong>options</strong>(opts)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Applies additional config options to this instance.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#rule-instance_method" title="#rule (instance method)">#<strong>rule</strong>(name, *productions)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Registers a new grammar rule.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#transform-instance_method" title="#transform (instance method)">#<strong>transform</strong>(name, value)  ⇒ String </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Applies the given modifier function to the given value to transform it.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#unique_expansion-instance_method" title="#unique_expansion (instance method)">#<strong>unique_expansion</strong>(symbol)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Expands a unique rule symbol by evaluating it and checking that it
hasn't previously been selected.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Registry (class)">Registry</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Construct an empty registry.</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


7
8
9
10
11
12</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 7</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span>
  <span class="ivar">@options</span> <span class="op">=</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Options (class)">Options</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Options#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="lbrace">{</span><span class="rbrace">}</span><span class="rparen">)</span>
  <span class="ivar">@rules</span> <span class="op">=</span> <span class="lbrace">{</span><span class="rbrace">}</span>
  <span class="ivar">@transforms</span> <span class="op">=</span> <span class="lbrace">{</span><span class="rbrace">}</span>
  <span class="ivar">@modifiers</span> <span class="op">=</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Modifiers (class)">Modifiers</a></span></span><span class="period">.</span><span class="id identifier rubyid_new">new</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>
<div id="method_missing_details" class="method_details_list">
  <h2>Dynamic Method Handling</h2>
  <p class="notice this">
    This class handles dynamic methods through the <tt>method_missing</tt> method

  </p>

    <div class="method_details first">
  <h3 class="signature first" id="method_missing-instance_method">

    #<strong>method_missing</strong>(name, *productions)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Registers a new grammar rule without explicitly calling the `#rule` method.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">name</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">productions</span>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 53</span>

<span class="kw">def</span> <span class="id identifier rubyid_method_missing">method_missing</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="op">*</span><span class="id identifier rubyid_productions">productions</span><span class="rparen">)</span>
  <span class="id identifier rubyid_define_rule">define_rule</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_caller_locations">caller_locations</span><span class="period">.</span><span class="id identifier rubyid_first">first</span><span class="comma">,</span> <span class="id identifier rubyid_productions">productions</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>


      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="modifiers-instance_method">

    #<strong>modifiers</strong>  ⇒ <tt>Object</tt>  <span class="extras">(readonly)</span>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns the value of attribute modifiers</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 4</span>

<span class="kw">def</span> <span class="id identifier rubyid_modifiers">modifiers</span>
  <span class="ivar">@modifiers</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>


      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="rules-instance_method">

    #<strong>rules</strong>  ⇒ <tt>Object</tt>  <span class="extras">(readonly)</span>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns the value of attribute rules</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 4</span>

<span class="kw">def</span> <span class="id identifier rubyid_rules">rules</span>
  <span class="ivar">@rules</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>


      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="transforms-instance_method">

    #<strong>transforms</strong>  ⇒ <tt>Object</tt>  <span class="extras">(readonly)</span>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Returns the value of attribute transforms</p>


  </div>
</div>
<div class="tags">


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 4</span>

<span class="kw">def</span> <span class="id identifier rubyid_transforms">transforms</span>
  <span class="ivar">@transforms</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="combine-instance_method">

    #<strong>combine</strong>(registry)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Merges the given registry instance with the target registry.</p>

<p>This is only needed at compile time, so that child classes can easily
inherit the set of rules decared by their parent.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">registry</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Registry (class)">Calyx::Registry</a></span></tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


148
149
150</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 148</span>

<span class="kw">def</span> <span class="id identifier rubyid_combine">combine</span><span class="lparen">(</span><span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
  <span class="ivar">@rules</span> <span class="op">=</span> <span class="id identifier rubyid_rules">rules</span><span class="period">.</span><span class="id identifier rubyid_merge">merge</span><span class="lparen">(</span><span class="id identifier rubyid_registry">registry</span><span class="period">.</span><span class="id identifier rubyid_rules">rules</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="define_context_rule-instance_method">

    #<strong>define_context_rule</strong>(name, trace, productions)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Defines a rule in the temporary evaluation context.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">name</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">productions</span>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


77
78
79
80</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 77</span>

<span class="kw">def</span> <span class="id identifier rubyid_define_context_rule">define_context_rule</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_trace">trace</span><span class="comma">,</span> <span class="id identifier rubyid_productions">productions</span><span class="rparen">)</span>
  <span class="id identifier rubyid_productions">productions</span> <span class="op">=</span> <span class="lbracket">[</span><span class="id identifier rubyid_productions">productions</span><span class="rbracket">]</span> <span class="kw">unless</span> <span class="id identifier rubyid_productions">productions</span><span class="period">.</span><span class="id identifier rubyid_is_a?">is_a?</span><span class="lparen">(</span><span class="const">Enumerable</span><span class="rparen">)</span>
  <span class="id identifier rubyid_context">context</span><span class="lbracket">[</span><span class="id identifier rubyid_name">name</span><span class="period">.</span><span class="id identifier rubyid_to_sym">to_sym</span><span class="rbracket">]</span> <span class="op">=</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Rule (class)">Rule</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Rule#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="period">.</span><span class="id identifier rubyid_to_sym">to_sym</span><span class="comma">,</span> <span class="id identifier rubyid_construct_rule">construct_rule</span><span class="lparen">(</span><span class="id identifier rubyid_productions">productions</span><span class="rparen">)</span><span class="comma">,</span> <span class="id identifier rubyid_trace">trace</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="define_rule-instance_method">

    #<strong>define_rule</strong>(name, trace, productions)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Defines a static rule in the grammar.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">name</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">productions</span>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


69
70
71</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 69</span>

<span class="kw">def</span> <span class="id identifier rubyid_define_rule">define_rule</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_trace">trace</span><span class="comma">,</span> <span class="id identifier rubyid_productions">productions</span><span class="rparen">)</span>
  <span class="id identifier rubyid_rules">rules</span><span class="lbracket">[</span><span class="id identifier rubyid_name">name</span><span class="period">.</span><span class="id identifier rubyid_to_sym">to_sym</span><span class="rbracket">]</span> <span class="op">=</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Rule (class)">Rule</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Rule#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="period">.</span><span class="id identifier rubyid_to_sym">to_sym</span><span class="comma">,</span> <span class="id identifier rubyid_construct_rule">construct_rule</span><span class="lparen">(</span><span class="id identifier rubyid_productions">productions</span><span class="rparen">)</span><span class="comma">,</span> <span class="id identifier rubyid_trace">trace</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="evaluate-instance_method">

    #<strong>evaluate</strong>(start_symbol = :start, rules_map = {})  ⇒ <tt>Array</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Evaluates the grammar defined in this registry, combining it with rules
from the passed in context.</p>

<p>Produces a syntax tree of nested list nodes.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">start_symbol</span>


        <span class="type">(<tt>Symbol</tt>)</span>


        <em class="default">(defaults to: <tt>:start</tt>)</em>


    </li>

    <li>

        <span class="name">rules_map</span>


        <span class="type">(<tt>Hash</tt>)</span>


        <em class="default">(defaults to: <tt>{}</tt>)</em>


    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


160
161
162
163
164
165
166
167
168
169
170
171
172</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 160</span>

<span class="kw">def</span> <span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_start_symbol">start_symbol</span><span class="op">=</span><span class="symbol">:start</span><span class="comma">,</span> <span class="id identifier rubyid_rules_map">rules_map</span><span class="op">=</span><span class="lbrace">{</span><span class="rbrace">}</span><span class="rparen">)</span>
  <span class="id identifier rubyid_reset_evaluation_context">reset_evaluation_context</span>

  <span class="id identifier rubyid_rules_map">rules_map</span><span class="period">.</span><span class="id identifier rubyid_each">each</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_key">key</span><span class="comma">,</span> <span class="id identifier rubyid_value">value</span><span class="op">|</span>
    <span class="kw">if</span> <span class="id identifier rubyid_rules">rules</span><span class="period">.</span><span class="id identifier rubyid_key?">key?</span><span class="lparen">(</span><span class="id identifier rubyid_key">key</span><span class="period">.</span><span class="id identifier rubyid_to_sym">to_sym</span><span class="rparen">)</span>
      <span class="id identifier rubyid_raise">raise</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Errors (module)">Errors</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="" title="Calyx::Errors::DuplicateRule (class)">DuplicateRule</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Errors::DuplicateRule#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_key">key</span><span class="rparen">)</span>
    <span class="kw">end</span>

    <span class="id identifier rubyid_define_context_rule">define_context_rule</span><span class="lparen">(</span><span class="id identifier rubyid_key">key</span><span class="comma">,</span> <span class="id identifier rubyid_caller_locations">caller_locations</span><span class="period">.</span><span class="id identifier rubyid_last">last</span><span class="comma">,</span> <span class="id identifier rubyid_value">value</span><span class="rparen">)</span>
  <span class="kw">end</span>

  <span class="lbracket">[</span><span class="id identifier rubyid_start_symbol">start_symbol</span><span class="comma">,</span> <span class="id identifier rubyid_expand">expand</span><span class="lparen">(</span><span class="id identifier rubyid_start_symbol">start_symbol</span><span class="rparen">)</span><span class="period">.</span><span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="ivar">@options</span><span class="rparen">)</span><span class="rbracket">]</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="expand-instance_method">

    #<strong>expand</strong>(symbol)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Rule (class)">Calyx::Rule</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Expands the given symbol to its rule.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">symbol</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Rule (class)">Calyx::Rule</a></span></tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88
89
90
91
92
93
94
95
96
97
98
99</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 86</span>

<span class="kw">def</span> <span class="id identifier rubyid_expand">expand</span><span class="lparen">(</span><span class="id identifier rubyid_symbol">symbol</span><span class="rparen">)</span>
  <span class="id identifier rubyid_expansion">expansion</span> <span class="op">=</span> <span class="id identifier rubyid_rules">rules</span><span class="lbracket">[</span><span class="id identifier rubyid_symbol">symbol</span><span class="rbracket">]</span> <span class="op">||</span> <span class="id identifier rubyid_context">context</span><span class="lbracket">[</span><span class="id identifier rubyid_symbol">symbol</span><span class="rbracket">]</span>

  <span class="kw">if</span> <span class="id identifier rubyid_expansion">expansion</span><span class="period">.</span><span class="id identifier rubyid_nil?">nil?</span>
    <span class="kw">if</span> <span class="ivar">@options</span><span class="period">.</span><span class="id identifier rubyid_strict?">strict?</span>
      <span class="id identifier rubyid_raise">raise</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Errors (module)">Errors</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="" title="Calyx::Errors::UndefinedRule (class)">UndefinedRule</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Errors::UndefinedRule#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="ivar">@last_expansion</span><span class="comma">,</span> <span class="id identifier rubyid_symbol">symbol</span><span class="rparen">)</span>
    <span class="kw">else</span>
      <span class="id identifier rubyid_expansion">expansion</span> <span class="op">=</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Production (module)">Production</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="" title="Calyx::Production::Terminal (class)">Terminal</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Production::Terminal#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="tstring"><span class="tstring_beg">'</span><span class="tstring_end">'</span></span><span class="rparen">)</span>
    <span class="kw">end</span>
  <span class="kw">end</span>

  <span class="ivar">@last_expansion</span> <span class="op">=</span> <span class="id identifier rubyid_expansion">expansion</span>
  <span class="id identifier rubyid_expansion">expansion</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="filter-instance_method">

    #<strong>filter</strong>(name, callable = nil) {|String| ... } ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Registers the given block as a string filter.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">name</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">

    <li>


        <span class="type">(<tt>String</tt>)</span>



    </li>

</ul>
<p class="tag_title">Yield Returns:</p>
<ul class="yieldreturn">

    <li>


        <span class="type">(<tt>String</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


41
42
43
44
45
46
47</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 41</span>

<span class="kw">def</span> <span class="id identifier rubyid_filter">filter</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_callable">callable</span><span class="op">=</span><span class="kw">nil</span><span class="comma">,</span> <span class="op">&amp;</span><span class="id identifier rubyid_block">block</span><span class="rparen">)</span>
  <span class="kw">if</span> <span class="id identifier rubyid_block_given?">block_given?</span>
    <span class="id identifier rubyid_transforms">transforms</span><span class="lbracket">[</span><span class="id identifier rubyid_name">name</span><span class="period">.</span><span class="id identifier rubyid_to_sym">to_sym</span><span class="rbracket">]</span> <span class="op">=</span> <span class="id identifier rubyid_block">block</span>
  <span class="kw">else</span>
    <span class="id identifier rubyid_transforms">transforms</span><span class="lbracket">[</span><span class="id identifier rubyid_name">name</span><span class="period">.</span><span class="id identifier rubyid_to_sym">to_sym</span><span class="rbracket">]</span> <span class="op">=</span> <span class="id identifier rubyid_callable">callable</span>
  <span class="kw">end</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="mapping-instance_method">

    #<strong>mapping</strong>(name, pairs)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Registers a paired mapping regex.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">name</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">pairs</span>


        <span class="type">(<tt>Hash&lt;Regex,String&gt;</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 32</span>

<span class="kw">def</span> <span class="id identifier rubyid_mapping">mapping</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_pairs">pairs</span><span class="rparen">)</span>
  <span class="id identifier rubyid_transforms">transforms</span><span class="lbracket">[</span><span class="id identifier rubyid_name">name</span><span class="period">.</span><span class="id identifier rubyid_to_sym">to_sym</span><span class="rbracket">]</span> <span class="op">=</span> <span class="id identifier rubyid_construct_mapping">construct_mapping</span><span class="lparen">(</span><span class="id identifier rubyid_pairs">pairs</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="memoize_expansion-instance_method">

    #<strong>memoize_expansion</strong>(symbol)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Expands a memoized rule symbol by evaluating it and storing the result for
later.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">symbol</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


118
119
120</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 118</span>

<span class="kw">def</span> <span class="id identifier rubyid_memoize_expansion">memoize_expansion</span><span class="lparen">(</span><span class="id identifier rubyid_symbol">symbol</span><span class="rparen">)</span>
  <span class="id identifier rubyid_memos">memos</span><span class="lbracket">[</span><span class="id identifier rubyid_symbol">symbol</span><span class="rbracket">]</span> <span class="op">||=</span> <span class="id identifier rubyid_expand">expand</span><span class="lparen">(</span><span class="id identifier rubyid_symbol">symbol</span><span class="rparen">)</span><span class="period">.</span><span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="ivar">@options</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="modifier-instance_method">

    #<strong>modifier</strong>(name)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Attaches a modifier module to this instance.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">name</span>


        <span class="type">(<tt>Module</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


24
25
26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 24</span>

<span class="kw">def</span> <span class="id identifier rubyid_modifier">modifier</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="rparen">)</span>
  <span class="id identifier rubyid_modifiers">modifiers</span><span class="period">.</span><span class="id identifier rubyid_extend">extend</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="options-instance_method">

    #<strong>options</strong>(opts)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Applies additional config options to this instance.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">opts</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Options (class)">Options</a></span></tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 17</span>

<span class="kw">def</span> <span class="id identifier rubyid_options">options</span><span class="lparen">(</span><span class="id identifier rubyid_opts">opts</span><span class="rparen">)</span>
  <span class="ivar">@options</span> <span class="op">=</span> <span class="ivar">@options</span><span class="period">.</span><span class="id identifier rubyid_merge">merge</span><span class="lparen">(</span><span class="id identifier rubyid_opts">opts</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="rule-instance_method">

    #<strong>rule</strong>(name, *productions)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Registers a new grammar rule.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">name</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">productions</span>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


61
62
63</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 61</span>

<span class="kw">def</span> <span class="id identifier rubyid_rule">rule</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="op">*</span><span class="id identifier rubyid_productions">productions</span><span class="rparen">)</span>
  <span class="id identifier rubyid_define_rule">define_rule</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_caller_locations">caller_locations</span><span class="period">.</span><span class="id identifier rubyid_first">first</span><span class="comma">,</span> <span class="id identifier rubyid_productions">productions</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="transform-instance_method">

    #<strong>transform</strong>(name, value)  ⇒ <tt>String</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Applies the given modifier function to the given value to transform it.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">name</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">value</span>


        <span class="type">(<tt>String</tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>String</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106
107
108
109
110
111
112</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 106</span>

<span class="kw">def</span> <span class="id identifier rubyid_transform">transform</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_value">value</span><span class="rparen">)</span>
  <span class="kw">if</span> <span class="id identifier rubyid_transforms">transforms</span><span class="period">.</span><span class="id identifier rubyid_key?">key?</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="rparen">)</span>
    <span class="id identifier rubyid_transforms">transforms</span><span class="lbracket">[</span><span class="id identifier rubyid_name">name</span><span class="rbracket">]</span><span class="period">.</span><span class="id identifier rubyid_call">call</span><span class="lparen">(</span><span class="id identifier rubyid_value">value</span><span class="rparen">)</span>
  <span class="kw">else</span>
    <span class="id identifier rubyid_modifiers">modifiers</span><span class="period">.</span><span class="id identifier rubyid_transform">transform</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_value">value</span><span class="rparen">)</span>
  <span class="kw">end</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

      <div class="method_details ">
  <h3 class="signature " id="unique_expansion-instance_method">

    #<strong>unique_expansion</strong>(symbol)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Expands a unique rule symbol by evaluating it and checking that it
hasn't previously been selected.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">symbol</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126
127
128
129
130
131
132
133
134
135
136
137
138
139
140</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/registry.rb', line 126</span>

<span class="kw">def</span> <span class="id identifier rubyid_unique_expansion">unique_expansion</span><span class="lparen">(</span><span class="id identifier rubyid_symbol">symbol</span><span class="rparen">)</span>
  <span class="id identifier rubyid_pending">pending</span> <span class="op">=</span> <span class="kw">true</span>
  <span class="id identifier rubyid_uniques">uniques</span><span class="lbracket">[</span><span class="id identifier rubyid_symbol">symbol</span><span class="rbracket">]</span> <span class="op">=</span> <span class="lbracket">[</span><span class="rbracket">]</span> <span class="kw">if</span> <span class="id identifier rubyid_uniques">uniques</span><span class="lbracket">[</span><span class="id identifier rubyid_symbol">symbol</span><span class="rbracket">]</span><span class="period">.</span><span class="id identifier rubyid_nil?">nil?</span>

  <span class="kw">while</span> <span class="id identifier rubyid_pending">pending</span>
    <span class="id identifier rubyid_result">result</span> <span class="op">=</span> <span class="id identifier rubyid_expand">expand</span><span class="lparen">(</span><span class="id identifier rubyid_symbol">symbol</span><span class="rparen">)</span><span class="period">.</span><span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="ivar">@options</span><span class="rparen">)</span>

    <span class="kw">unless</span> <span class="id identifier rubyid_uniques">uniques</span><span class="lbracket">[</span><span class="id identifier rubyid_symbol">symbol</span><span class="rbracket">]</span><span class="period">.</span><span class="id identifier rubyid_include?">include?</span><span class="lparen">(</span><span class="id identifier rubyid_result">result</span><span class="rparen">)</span>
      <span class="id identifier rubyid_uniques">uniques</span><span class="lbracket">[</span><span class="id identifier rubyid_symbol">symbol</span><span class="rbracket">]</span> <span class="op">&lt;&lt;</span> <span class="id identifier rubyid_result">result</span>
      <span class="id identifier rubyid_pending">pending</span> <span class="op">=</span> <span class="kw">false</span>
    <span class="kw">end</span>
  <span class="kw">end</span>

  <span class="id identifier rubyid_result">result</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Modifiers



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Modifiers</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/modifiers.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>Applies modifiers to the output of a rule in a template substitution.</p>


  </div>
</div>
<div class="tags">


</div>







    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#transform-instance_method" title="#transform (instance method)">#<strong>transform</strong>(name, value)  ⇒ String </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Transforms an output string by delegating to the given output function.</p>
</div></span>

</li>


    </ul>




  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="transform-instance_method">

    #<strong>transform</strong>(name, value)  ⇒ <tt>String</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Transforms an output string by delegating to the given output function.</p>

<p>If a registered modifier method is not found, then delegate to the given
string function.</p>

<p>If an invalid modifier function is given, returns the raw input string.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">name</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">value</span>


        <span class="type">(<tt>String</tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>String</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


14
15
16
17
18
19
20
21
22</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/modifiers.rb', line 14</span>

<span class="kw">def</span> <span class="id identifier rubyid_transform">transform</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_value">value</span><span class="rparen">)</span>
  <span class="kw">if</span> <span class="id identifier rubyid_respond_to?">respond_to?</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="rparen">)</span>
    <span class="id identifier rubyid_send">send</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="comma">,</span> <span class="id identifier rubyid_value">value</span><span class="rparen">)</span>
  <span class="kw">elsif</span> <span class="id identifier rubyid_value">value</span><span class="period">.</span><span class="id identifier rubyid_respond_to?">respond_to?</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="rparen">)</span>
    <span class="id identifier rubyid_value">value</span><span class="period">.</span><span class="id identifier rubyid_send">send</span><span class="lparen">(</span><span class="id identifier rubyid_name">name</span><span class="rparen">)</span>
  <span class="kw">else</span>
    <span class="id identifier rubyid_value">value</span>
  <span class="kw">end</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Production::Memo



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Production::Memo</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/production/memo.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>A type of production rule representing a memoized subsitution which returns
the first value selected on all subsequent lookups.</p>


  </div>
</div>
<div class="tags">


</div>
  <h2>Constant Summary</h2>
  <dl class="constants">

      <dt id="SIGIL-constant" class="">SIGIL =

      </dt>
      <dd><pre class="code"><span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">@</span><span class="tstring_end">'</span></span><span class="period">.</span><span class="id identifier rubyid_freeze">freeze</span></pre></dd>

  </dl>








    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#evaluate-instance_method" title="#evaluate (instance method)">#<strong>evaluate</strong>(options)  ⇒ Array </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Evaluate the memo, using the registry to handle the expansion.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(symbol, registry)  ⇒ Memo </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>Construct a memoized rule, given the symbol to lookup and the registry to
look it up in.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(symbol, registry)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Production::Memo (class)">Memo</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Construct a memoized rule, given the symbol to lookup and the registry to
look it up in.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">symbol</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">registry</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Registry (class)">Calyx::Registry</a></span></tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


13
14
15
16</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/memo.rb', line 13</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_symbol">symbol</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
  <span class="ivar">@symbol</span> <span class="op">=</span> <span class="id identifier rubyid_symbol">symbol</span><span class="period">.</span><span class="id identifier rubyid_slice">slice</span><span class="lparen">(</span><span class="int">1</span><span class="comma">,</span> <span class="id identifier rubyid_symbol">symbol</span><span class="period">.</span><span class="id identifier rubyid_length">length</span><span class="op">-</span><span class="int">1</span><span class="rparen">)</span><span class="period">.</span><span class="id identifier rubyid_to_sym">to_sym</span>
  <span class="ivar">@registry</span> <span class="op">=</span> <span class="id identifier rubyid_registry">registry</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="evaluate-instance_method">

    #<strong>evaluate</strong>(options)  ⇒ <tt>Array</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Evaluate the memo, using the registry to handle the expansion.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">options</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Options (class)">Calyx::Options</a></span></tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


22
23
24</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/memo.rb', line 22</span>

<span class="kw">def</span> <span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span>
  <span class="lbracket">[</span><span class="ivar">@symbol</span><span class="comma">,</span> <span class="ivar">@registry</span><span class="period">.</span><span class="id identifier rubyid_memoize_expansion">memoize_expansion</span><span class="lparen">(</span><span class="ivar">@symbol</span><span class="rparen">)</span><span class="rbracket">]</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Production::Concat



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Production::Concat</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/production/concat.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>A type of production rule representing a string combining both template
substitutions and raw content.</p>


  </div>
</div>
<div class="tags">


</div>
  <h2>Constant Summary</h2>
  <dl class="constants">

      <dt id="EXPRESSION-constant" class="">EXPRESSION =

      </dt>
      <dd><pre class="code"><span class="tstring"><span class="regexp_beg">/</span><span class="tstring_content">(\{[A-Za-z0-9_@$\.]+\})</span><span class="regexp_end">/</span></span><span class="period">.</span><span class="id identifier rubyid_freeze">freeze</span></pre></dd>

      <dt id="START_TOKEN-constant" class="">START_TOKEN =

      </dt>
      <dd><pre class="code"><span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">{</span><span class="tstring_end">'</span></span><span class="period">.</span><span class="id identifier rubyid_freeze">freeze</span></pre></dd>

      <dt id="END_TOKEN-constant" class="">END_TOKEN =

      </dt>
      <dd><pre class="code"><span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">}</span><span class="tstring_end">'</span></span><span class="period">.</span><span class="id identifier rubyid_freeze">freeze</span></pre></dd>

      <dt id="DEREF_TOKEN-constant" class="">DEREF_TOKEN =

      </dt>
      <dd><pre class="code"><span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">.</span><span class="tstring_end">'</span></span><span class="period">.</span><span class="id identifier rubyid_freeze">freeze</span></pre></dd>

  </dl>








    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#parse-class_method" title="parse (class method)">.<strong>parse</strong>(production, registry)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Parses an interpolated string into fragments combining terminal strings and
non-terminal rules.</p>
</div></span>

</li>


    </ul>

    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#evaluate-instance_method" title="#evaluate (instance method)">#<strong>evaluate</strong>(options)  ⇒ Array </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Evaluate all the child nodes of this node and concatenate them together
into a single result.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(expansion)  ⇒ Concat </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>Initialize the concat node with an expansion of terminal and non-terminal
fragments.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(expansion)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Production::Concat (class)">Concat</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Initialize the concat node with an expansion of terminal and non-terminal
fragments.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">expansion</span>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/concat.rb', line 48</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_expansion">expansion</span><span class="rparen">)</span>
  <span class="ivar">@expansion</span> <span class="op">=</span> <span class="id identifier rubyid_expansion">expansion</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="parse-class_method">

    .<strong>parse</strong>(production, registry)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Parses an interpolated string into fragments combining terminal strings and
non-terminal rules.</p>

<p>Returns a concat node which is the head of a tree of child nodes.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">production</span>


        <span class="type">(<tt>String</tt>)</span>



    </li>

    <li>

        <span class="name">registry</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Registry (class)">Calyx::Registry</a></span></tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/concat.rb', line 18</span>

<span class="kw">def</span> <span class="kw">self</span><span class="period">.</span><span class="id identifier rubyid_parse">parse</span><span class="lparen">(</span><span class="id identifier rubyid_production">production</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
  <span class="id identifier rubyid_expansion">expansion</span> <span class="op">=</span> <span class="id identifier rubyid_production">production</span><span class="period">.</span><span class="id identifier rubyid_split">split</span><span class="lparen">(</span><span class="const"><span class="object_link"><a href="#EXPRESSION-constant" title="Calyx::Production::Concat::EXPRESSION (constant)">EXPRESSION</a></span></span><span class="rparen">)</span><span class="period">.</span><span class="id identifier rubyid_map">map</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_atom">atom</span><span class="op">|</span>
    <span class="kw">if</span> <span class="id identifier rubyid_atom">atom</span><span class="period">.</span><span class="id identifier rubyid_is_a?">is_a?</span><span class="lparen">(</span><span class="const">String</span><span class="rparen">)</span>
      <span class="kw">if</span> <span class="id identifier rubyid_atom">atom</span><span class="period">.</span><span class="id identifier rubyid_chars">chars</span><span class="period">.</span><span class="id identifier rubyid_first">first</span> <span class="op">==</span> <span class="const"><span class="object_link"><a href="#START_TOKEN-constant" title="Calyx::Production::Concat::START_TOKEN (constant)">START_TOKEN</a></span></span> <span class="op">&amp;&amp;</span> <span class="id identifier rubyid_atom">atom</span><span class="period">.</span><span class="id identifier rubyid_chars">chars</span><span class="period">.</span><span class="id identifier rubyid_last">last</span> <span class="op">==</span> <span class="const"><span class="object_link"><a href="#END_TOKEN-constant" title="Calyx::Production::Concat::END_TOKEN (constant)">END_TOKEN</a></span></span>
        <span class="id identifier rubyid_head">head</span><span class="comma">,</span> <span class="op">*</span><span class="id identifier rubyid_tail">tail</span> <span class="op">=</span> <span class="id identifier rubyid_atom">atom</span><span class="period">.</span><span class="id identifier rubyid_slice">slice</span><span class="lparen">(</span><span class="int">1</span><span class="comma">,</span> <span class="id identifier rubyid_atom">atom</span><span class="period">.</span><span class="id identifier rubyid_length">length</span><span class="op">-</span><span class="int">2</span><span class="rparen">)</span><span class="period">.</span><span class="id identifier rubyid_split">split</span><span class="lparen">(</span><span class="const"><span class="object_link"><a href="#DEREF_TOKEN-constant" title="Calyx::Production::Concat::DEREF_TOKEN (constant)">DEREF_TOKEN</a></span></span><span class="rparen">)</span>
        <span class="kw">if</span> <span class="id identifier rubyid_head">head</span><span class="lbracket">[</span><span class="int">0</span><span class="rbracket">]</span> <span class="op">==</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Production::Memo (class)">Memo</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="#SIGIL-constant" title="Calyx::Production::Memo::SIGIL (constant)">SIGIL</a></span></span>
          <span class="id identifier rubyid_rule">rule</span> <span class="op">=</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Production::Memo (class)">Memo</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Production::Memo#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_head">head</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
        <span class="kw">elsif</span> <span class="id identifier rubyid_head">head</span><span class="lbracket">[</span><span class="int">0</span><span class="rbracket">]</span> <span class="op">==</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Production::Unique (class)">Unique</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="#SIGIL-constant" title="Calyx::Production::Unique::SIGIL (constant)">SIGIL</a></span></span>
          <span class="id identifier rubyid_rule">rule</span> <span class="op">=</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Production::Unique (class)">Unique</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Production::Unique#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_head">head</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
        <span class="kw">else</span>
          <span class="id identifier rubyid_rule">rule</span> <span class="op">=</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Production::NonTerminal (class)">NonTerminal</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Production::NonTerminal#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_head">head</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
        <span class="kw">end</span>
        <span class="kw">unless</span> <span class="id identifier rubyid_tail">tail</span><span class="period">.</span><span class="id identifier rubyid_empty?">empty?</span>
          <span class="const"><span class="object_link"><a href="" title="Calyx::Production::Expression (class)">Expression</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Production::Expression#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_rule">rule</span><span class="comma">,</span> <span class="id identifier rubyid_tail">tail</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
        <span class="kw">else</span>
          <span class="id identifier rubyid_rule">rule</span>
        <span class="kw">end</span>
      <span class="kw">else</span>
        <span class="const"><span class="object_link"><a href="" title="Calyx::Production::Terminal (class)">Terminal</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Production::Terminal#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_atom">atom</span><span class="rparen">)</span>
      <span class="kw">end</span>
    <span class="kw">end</span>
  <span class="kw">end</span>

  <span class="kw">self</span><span class="period">.</span><span class="id identifier rubyid_new">new</span><span class="lparen">(</span><span class="id identifier rubyid_expansion">expansion</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="evaluate-instance_method">

    #<strong>evaluate</strong>(options)  ⇒ <tt>Array</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Evaluate all the child nodes of this node and concatenate them together
into a single result.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">options</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Options (class)">Calyx::Options</a></span></tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


57
58
59
60
61
62
63</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/concat.rb', line 57</span>

<span class="kw">def</span> <span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span>
  <span class="id identifier rubyid_concat">concat</span> <span class="op">=</span> <span class="ivar">@expansion</span><span class="period">.</span><span class="id identifier rubyid_reduce">reduce</span><span class="lparen">(</span><span class="lbracket">[</span><span class="rbracket">]</span><span class="rparen">)</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_exp">exp</span><span class="comma">,</span> <span class="id identifier rubyid_atom">atom</span><span class="op">|</span>
    <span class="id identifier rubyid_exp">exp</span> <span class="op">&lt;&lt;</span> <span class="id identifier rubyid_atom">atom</span><span class="period">.</span><span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span>
  <span class="kw">end</span>

  <span class="lbracket">[</span><span class="symbol">:concat</span><span class="comma">,</span> <span class="id identifier rubyid_concat">concat</span><span class="rbracket">]</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Production::Unique



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Production::Unique</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/production/unique.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>A type of production rule representing a unique substitution which only
returns values that have not previously been selected. The probability that
a given rule will be selected increases as more selections are made and the
list grows smaller.</p>

<p>TODO: handle wraparound</p>


  </div>
</div>
<div class="tags">


</div>
  <h2>Constant Summary</h2>
  <dl class="constants">

      <dt id="SIGIL-constant" class="">SIGIL =

      </dt>
      <dd><pre class="code"><span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">$</span><span class="tstring_end">'</span></span><span class="period">.</span><span class="id identifier rubyid_freeze">freeze</span></pre></dd>

  </dl>








    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#evaluate-instance_method" title="#evaluate (instance method)">#<strong>evaluate</strong>(options)  ⇒ Array </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Evaluate the unique rule, using the registry to handle the expansion and
keep track of previous selections.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(symbol, registry)  ⇒ Unique </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>Construct a unique rule, given the symbol to lookup and the registry to
look it up in.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(symbol, registry)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Production::Unique (class)">Unique</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Construct a unique rule, given the symbol to lookup and the registry to
look it up in.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">symbol</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">registry</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Registry (class)">Calyx::Registry</a></span></tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19
20</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/unique.rb', line 17</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_symbol">symbol</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
  <span class="ivar">@symbol</span> <span class="op">=</span> <span class="id identifier rubyid_symbol">symbol</span><span class="period">.</span><span class="id identifier rubyid_slice">slice</span><span class="lparen">(</span><span class="int">1</span><span class="comma">,</span> <span class="id identifier rubyid_symbol">symbol</span><span class="period">.</span><span class="id identifier rubyid_length">length</span><span class="op">-</span><span class="int">1</span><span class="rparen">)</span><span class="period">.</span><span class="id identifier rubyid_to_sym">to_sym</span>
  <span class="ivar">@registry</span> <span class="op">=</span> <span class="id identifier rubyid_registry">registry</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="evaluate-instance_method">

    #<strong>evaluate</strong>(options)  ⇒ <tt>Array</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Evaluate the unique rule, using the registry to handle the expansion and
keep track of previous selections.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">options</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Options (class)">Calyx::Options</a></span></tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/unique.rb', line 27</span>

<span class="kw">def</span> <span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span>
  <span class="lbracket">[</span><span class="ivar">@symbol</span><span class="comma">,</span> <span class="ivar">@registry</span><span class="period">.</span><span class="id identifier rubyid_unique_expansion">unique_expansion</span><span class="lparen">(</span><span class="ivar">@symbol</span><span class="rparen">)</span><span class="rbracket">]</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Production::Choices



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Production::Choices</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/production/choices.rb</dd>
  </dl>

</div>









    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#parse-class_method" title="parse (class method)">.<strong>parse</strong>(productions, registry)  ⇒ Object </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Parse a list of productions and return a choice node which is the head of a
syntax tree of child nodes.</p>
</div></span>

</li>


    </ul>

    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#evaluate-instance_method" title="#evaluate (instance method)">#<strong>evaluate</strong>(options)  ⇒ Array </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Evaluate the choice by randomly picking one of its possible options.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(collection)  ⇒ Choices </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>Initialize a new choice with a list of child nodes.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(collection)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Production::Choices (class)">Choices</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Initialize a new choice with a list of child nodes.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">collection</span>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


33
34
35</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/choices.rb', line 33</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_collection">collection</span><span class="rparen">)</span>
  <span class="ivar">@collection</span> <span class="op">=</span> <span class="id identifier rubyid_collection">collection</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="parse-class_method">

    .<strong>parse</strong>(productions, registry)  ⇒ <tt>Object</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Parse a list of productions and return a choice node which is the head of a
syntax tree of child nodes.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">productions</span>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

    <li>

        <span class="name">registry</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Registry (class)">Calyx::Registry</a></span></tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/choices.rb', line 11</span>

<span class="kw">def</span> <span class="kw">self</span><span class="period">.</span><span class="id identifier rubyid_parse">parse</span><span class="lparen">(</span><span class="id identifier rubyid_productions">productions</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
  <span class="id identifier rubyid_choices">choices</span> <span class="op">=</span> <span class="id identifier rubyid_productions">productions</span><span class="period">.</span><span class="id identifier rubyid_map">map</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_choice">choice</span><span class="op">|</span>
    <span class="kw">if</span> <span class="id identifier rubyid_choice">choice</span><span class="period">.</span><span class="id identifier rubyid_is_a?">is_a?</span><span class="lparen">(</span><span class="const">String</span><span class="rparen">)</span>
      <span class="const"><span class="object_link"><a href="" title="Calyx::Production::Concat (class)">Concat</a></span></span><span class="period">.</span><span class="id identifier rubyid_parse"><span class="object_link"><a href="#parse-class_method" title="Calyx::Production::Concat.parse (method)">parse</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_choice">choice</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
    <span class="kw">elsif</span> <span class="id identifier rubyid_choice">choice</span><span class="period">.</span><span class="id identifier rubyid_is_a?">is_a?</span><span class="lparen">(</span><span class="const">Integer</span><span class="rparen">)</span>
      <span class="const"><span class="object_link"><a href="" title="Calyx::Production::Terminal (class)">Terminal</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Production::Terminal#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_choice">choice</span><span class="period">.</span><span class="id identifier rubyid_to_s">to_s</span><span class="rparen">)</span>
    <span class="kw">elsif</span> <span class="id identifier rubyid_choice">choice</span><span class="period">.</span><span class="id identifier rubyid_is_a?">is_a?</span><span class="lparen">(</span><span class="const">Symbol</span><span class="rparen">)</span>
      <span class="kw">if</span> <span class="id identifier rubyid_choice">choice</span><span class="lbracket">[</span><span class="int">0</span><span class="rbracket">]</span> <span class="op">==</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Production::Memo (class)">Memo</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="#SIGIL-constant" title="Calyx::Production::Memo::SIGIL (constant)">SIGIL</a></span></span>
        <span class="const"><span class="object_link"><a href="" title="Calyx::Production::Memo (class)">Memo</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Production::Memo#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_choice">choice</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
      <span class="kw">elsif</span> <span class="id identifier rubyid_choice">choice</span><span class="lbracket">[</span><span class="int">0</span><span class="rbracket">]</span> <span class="op">==</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Production::Unique (class)">Unique</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="#SIGIL-constant" title="Calyx::Production::Unique::SIGIL (constant)">SIGIL</a></span></span>
        <span class="const"><span class="object_link"><a href="" title="Calyx::Production::Unique (class)">Unique</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Production::Unique#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_choice">choice</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
      <span class="kw">else</span>
        <span class="const"><span class="object_link"><a href="" title="Calyx::Production::NonTerminal (class)">NonTerminal</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Production::NonTerminal#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_choice">choice</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
      <span class="kw">end</span>
    <span class="kw">end</span>
  <span class="kw">end</span>
  <span class="kw">self</span><span class="period">.</span><span class="id identifier rubyid_new">new</span><span class="lparen">(</span><span class="id identifier rubyid_choices">choices</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="evaluate-instance_method">

    #<strong>evaluate</strong>(options)  ⇒ <tt>Array</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Evaluate the choice by randomly picking one of its possible options.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">options</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Options (class)">Calyx::Options</a></span></tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


41
42
43</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/choices.rb', line 41</span>

<span class="kw">def</span> <span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span>
  <span class="lbracket">[</span><span class="symbol">:choice</span><span class="comma">,</span> <span class="ivar">@collection</span><span class="period">.</span><span class="id identifier rubyid_sample">sample</span><span class="lparen">(</span><span class="label">random:</span> <span class="id identifier rubyid_options">options</span><span class="period">.</span><span class="id identifier rubyid_rng">rng</span><span class="rparen">)</span><span class="period">.</span><span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span><span class="rbracket">]</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Production::Terminal



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Production::Terminal</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/production/terminal.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>A type of production rule that terminates with a resulting string atom.</p>


  </div>
</div>
<div class="tags">


</div>







    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#evaluate-instance_method" title="#evaluate (instance method)">#<strong>evaluate</strong>(options)  ⇒ Array </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Evaluate the terminal by returning its identity directly.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(atom)  ⇒ Terminal </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>Construct a terminal node with the given value.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(atom)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Production::Terminal (class)">Terminal</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Construct a terminal node with the given value.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">atom</span>


        <span class="type">(<tt>#to_s</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


8
9
10</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/terminal.rb', line 8</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_atom">atom</span><span class="rparen">)</span>
  <span class="ivar">@atom</span> <span class="op">=</span> <span class="id identifier rubyid_atom">atom</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="evaluate-instance_method">

    #<strong>evaluate</strong>(options)  ⇒ <tt>Array</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Evaluate the terminal by returning its identity directly.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">options</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Options (class)">Calyx::Options</a></span></tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/terminal.rb', line 16</span>

<span class="kw">def</span> <span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span>
  <span class="lbracket">[</span><span class="symbol">:atom</span><span class="comma">,</span> <span class="ivar">@atom</span><span class="rbracket">]</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Production::Expression



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Production::Expression</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/production/expression.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>A type of production rule representing a single template substitution.</p>


  </div>
</div>
<div class="tags">


</div>







    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#evaluate-instance_method" title="#evaluate (instance method)">#<strong>evaluate</strong>(options)  ⇒ Array </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Evaluate the expression by expanding the non-terminal to produce a terminal
string, then passing it through the given modifier chain and returning the
transformed result.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(production, methods, registry)  ⇒ Expression </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>Constructs a node representing a single template substitution.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(production, methods, registry)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Production::Expression (class)">Expression</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Constructs a node representing a single template substitution.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">production</span>


        <span class="type">(<tt>#<span class="object_link"><a href="#evaluate-instance_method" title="Calyx::Production::Expression#evaluate (method)">evaluate</a></span></tt>)</span>



    </li>

    <li>

        <span class="name">methods</span>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

    <li>

        <span class="name">registry</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Registry (class)">Calyx::Registry</a></span></tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


10
11
12
13
14</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/expression.rb', line 10</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_production">production</span><span class="comma">,</span> <span class="id identifier rubyid_methods">methods</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
  <span class="ivar">@production</span> <span class="op">=</span> <span class="id identifier rubyid_production">production</span>
  <span class="ivar">@methods</span> <span class="op">=</span> <span class="id identifier rubyid_methods">methods</span><span class="period">.</span><span class="id identifier rubyid_map">map</span> <span class="lbrace">{</span> <span class="op">|</span><span class="id identifier rubyid_m">m</span><span class="op">|</span> <span class="id identifier rubyid_m">m</span><span class="period">.</span><span class="id identifier rubyid_to_sym">to_sym</span> <span class="rbrace">}</span>
  <span class="ivar">@registry</span> <span class="op">=</span> <span class="id identifier rubyid_registry">registry</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="evaluate-instance_method">

    #<strong>evaluate</strong>(options)  ⇒ <tt>Array</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Evaluate the expression by expanding the non-terminal to produce a terminal
string, then passing it through the given modifier chain and returning the
transformed result.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">options</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Options (class)">Calyx::Options</a></span></tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


22
23
24
25
26
27
28
29</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/expression.rb', line 22</span>

<span class="kw">def</span> <span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span>
  <span class="id identifier rubyid_terminal">terminal</span> <span class="op">=</span> <span class="ivar">@production</span><span class="period">.</span><span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span><span class="period">.</span><span class="id identifier rubyid_flatten">flatten</span><span class="period">.</span><span class="id identifier rubyid_reject">reject</span> <span class="lbrace">{</span> <span class="op">|</span><span class="id identifier rubyid_o">o</span><span class="op">|</span> <span class="id identifier rubyid_o">o</span><span class="period">.</span><span class="id identifier rubyid_is_a?">is_a?</span><span class="lparen">(</span><span class="const">Symbol</span><span class="rparen">)</span> <span class="rbrace">}</span><span class="period">.</span><span class="id identifier rubyid_join">join</span>
  <span class="id identifier rubyid_expression">expression</span> <span class="op">=</span> <span class="ivar">@methods</span><span class="period">.</span><span class="id identifier rubyid_reduce">reduce</span><span class="lparen">(</span><span class="id identifier rubyid_terminal">terminal</span><span class="rparen">)</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_value">value</span><span class="comma">,</span> <span class="id identifier rubyid_method">method</span><span class="op">|</span>
    <span class="ivar">@registry</span><span class="period">.</span><span class="id identifier rubyid_transform">transform</span><span class="lparen">(</span><span class="id identifier rubyid_method">method</span><span class="comma">,</span> <span class="id identifier rubyid_value">value</span><span class="rparen">)</span>
  <span class="kw">end</span>

  <span class="lbracket">[</span><span class="symbol">:expression</span><span class="comma">,</span> <span class="id identifier rubyid_expression">expression</span><span class="rbracket">]</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Production::NonTerminal



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Production::NonTerminal</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/production/non_terminal.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>A type of production rule that represents a non-terminal expansion, linking
one rule to another.</p>


  </div>
</div>
<div class="tags">


</div>







    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#evaluate-instance_method" title="#evaluate (instance method)">#<strong>evaluate</strong>(options)  ⇒ Array </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Evaluate the non-terminal, using the registry to handle the expansion.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(symbol, registry)  ⇒ NonTerminal </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>Construct a non-terminal node, given the symbol to lookup and the registry
to look it up in.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(symbol, registry)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Production::NonTerminal (class)">NonTerminal</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Construct a non-terminal node, given the symbol to lookup and the registry
to look it up in.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">symbol</span>


        <span class="type">(<tt>Symbol</tt>)</span>



    </li>

    <li>

        <span class="name">registry</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Registry (class)">Calyx::Registry</a></span></tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13
14</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/non_terminal.rb', line 11</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_symbol">symbol</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
  <span class="ivar">@symbol</span> <span class="op">=</span> <span class="id identifier rubyid_symbol">symbol</span><span class="period">.</span><span class="id identifier rubyid_to_sym">to_sym</span>
  <span class="ivar">@registry</span> <span class="op">=</span> <span class="id identifier rubyid_registry">registry</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="evaluate-instance_method">

    #<strong>evaluate</strong>(options)  ⇒ <tt>Array</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Evaluate the non-terminal, using the registry to handle the expansion.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">options</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Options (class)">Calyx::Options</a></span></tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


20
21
22</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/non_terminal.rb', line 20</span>

<span class="kw">def</span> <span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span>
  <span class="lbracket">[</span><span class="ivar">@symbol</span><span class="comma">,</span> <span class="ivar">@registry</span><span class="period">.</span><span class="id identifier rubyid_expand">expand</span><span class="lparen">(</span><span class="ivar">@symbol</span><span class="rparen">)</span><span class="period">.</span><span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span><span class="rbracket">]</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


<h1>Class: Calyx::Production::WeightedChoices



</h1>
<div class="box_info">

  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>

        <ul class="fullTree">
          <li>Object</li>

            <li class="next">Calyx::Production::WeightedChoices</li>

        </ul>
        <a href="#" class="inheritanceTree">show all</a>

    </dd>
  </dl>











  <dl>
    <dt>Defined in:</dt>
    <dd>lib/calyx/production/weighted_choices.rb</dd>
  </dl>

</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">

<p>A type of production rule representing a map of possible rules with
associated weights that define the expected probability of a rule being
chosen.</p>


  </div>
</div>
<div class="tags">


</div>







    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#parse-class_method" title="parse (class method)">.<strong>parse</strong>(productions, registry)  ⇒ Calyx::Production::WeightedChoices </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Parse a given list or hash of productions into a syntax tree of weighted
choices.</p>
</div></span>

</li>


    </ul>

    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">

        <li class="public ">
  <span class="summary_signature">

      <a href="#evaluate-instance_method" title="#evaluate (instance method)">#<strong>evaluate</strong>(options)  ⇒ Array </a>



  </span>









    <span class="summary_desc"><div class="inline">
<p>Evaluate the choice by randomly picking one of its possible options,
balanced according to the given weights.</p>
</div></span>

</li>


        <li class="public ">
  <span class="summary_signature">

      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(collection)  ⇒ WeightedChoices </a>



  </span>


    <span class="note title constructor">constructor</span>








    <span class="summary_desc"><div class="inline">
<p>Initialize a new choice with a list of child nodes.</p>
</div></span>

</li>


    </ul>


<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>

    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">

    #<strong>initialize</strong>(collection)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Production::WeightedChoices (class)">WeightedChoices</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Initialize a new choice with a list of child nodes.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">collection</span>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>


</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/weighted_choices.rb', line 62</span>

<span class="kw">def</span> <span class="id identifier rubyid_initialize">initialize</span><span class="lparen">(</span><span class="id identifier rubyid_collection">collection</span><span class="rparen">)</span>
  <span class="ivar">@collection</span> <span class="op">=</span> <span class="id identifier rubyid_collection">collection</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="parse-class_method">

    .<strong>parse</strong>(productions, registry)  ⇒ <tt><span class="object_link"><a href="" title="Calyx::Production::WeightedChoices (class)">Calyx::Production::WeightedChoices</a></span></tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Parse a given list or hash of productions into a syntax tree of weighted
choices. Supports weights specified as Range, Fixnum and Float types.</p>

<p>All weights get normalized to a set of values in the 0..1 interval that sum
to 1.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">productions</span>


        <span class="type">(<tt>Array&lt;Array&gt;</tt>, <tt>Hash&lt;#to_s, Float&gt;</tt>)</span>



    </li>

    <li>

        <span class="name">registry</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Registry (class)">Calyx::Registry</a></span></tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Production::WeightedChoices (class)">Calyx::Production::WeightedChoices</a></span></tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/weighted_choices.rb', line 16</span>

<span class="kw">def</span> <span class="kw">self</span><span class="period">.</span><span class="id identifier rubyid_parse">parse</span><span class="lparen">(</span><span class="id identifier rubyid_productions">productions</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span>
  <span class="kw">if</span> <span class="id identifier rubyid_productions">productions</span><span class="period">.</span><span class="id identifier rubyid_first">first</span><span class="period">.</span><span class="id identifier rubyid_last">last</span><span class="period">.</span><span class="id identifier rubyid_is_a?">is_a?</span><span class="lparen">(</span><span class="const">Range</span><span class="rparen">)</span>
    <span class="id identifier rubyid_range_max">range_max</span> <span class="op">=</span> <span class="id identifier rubyid_productions">productions</span><span class="period">.</span><span class="id identifier rubyid_max">max</span> <span class="lbrace">{</span> <span class="op">|</span><span class="id identifier rubyid_a">a</span><span class="comma">,</span><span class="id identifier rubyid_b">b</span><span class="op">|</span> <span class="id identifier rubyid_a">a</span><span class="period">.</span><span class="id identifier rubyid_last">last</span><span class="period">.</span><span class="id identifier rubyid_max">max</span> <span class="op">&lt;=&gt;</span> <span class="id identifier rubyid_b">b</span><span class="period">.</span><span class="id identifier rubyid_last">last</span><span class="period">.</span><span class="id identifier rubyid_max">max</span> <span class="rbrace">}</span><span class="period">.</span><span class="id identifier rubyid_last">last</span><span class="period">.</span><span class="id identifier rubyid_max">max</span>

    <span class="id identifier rubyid_weights_sum">weights_sum</span> <span class="op">=</span> <span class="id identifier rubyid_productions">productions</span><span class="period">.</span><span class="id identifier rubyid_reduce">reduce</span><span class="lparen">(</span><span class="int">0</span><span class="rparen">)</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_memo">memo</span><span class="comma">,</span> <span class="id identifier rubyid_choice">choice</span><span class="op">|</span>
      <span class="id identifier rubyid_memo">memo</span> <span class="op">+=</span> <span class="id identifier rubyid_choice">choice</span><span class="period">.</span><span class="id identifier rubyid_last">last</span><span class="period">.</span><span class="id identifier rubyid_size">size</span>
    <span class="kw">end</span>

    <span class="kw">if</span> <span class="id identifier rubyid_range_max">range_max</span> <span class="op">!=</span> <span class="id identifier rubyid_weights_sum">weights_sum</span>
      <span class="id identifier rubyid_raise">raise</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Errors (module)">Errors</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="" title="Calyx::Errors::InvalidDefinition (class)">InvalidDefinition</a></span></span><span class="comma">,</span> <span class="tstring"><span class="tstring_beg">"</span><span class="tstring_content">Weights must sum to total: </span><span class="embexpr_beg">#{</span><span class="id identifier rubyid_range_max">range_max</span><span class="embexpr_end">}</span><span class="tstring_end">"</span></span>
    <span class="kw">end</span>

    <span class="id identifier rubyid_normalized_productions">normalized_productions</span> <span class="op">=</span> <span class="id identifier rubyid_productions">productions</span><span class="period">.</span><span class="id identifier rubyid_map">map</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_choice">choice</span><span class="op">|</span>
      <span class="id identifier rubyid_weight">weight</span> <span class="op">=</span> <span class="id identifier rubyid_choice">choice</span><span class="period">.</span><span class="id identifier rubyid_last">last</span><span class="period">.</span><span class="id identifier rubyid_size">size</span> <span class="op">/</span> <span class="id identifier rubyid_range_max">range_max</span><span class="period">.</span><span class="id identifier rubyid_to_f">to_f</span>
      <span class="lbracket">[</span><span class="id identifier rubyid_choice">choice</span><span class="period">.</span><span class="id identifier rubyid_first">first</span><span class="comma">,</span> <span class="id identifier rubyid_weight">weight</span><span class="rbracket">]</span>
    <span class="kw">end</span>
  <span class="kw">else</span>
    <span class="id identifier rubyid_weights_sum">weights_sum</span> <span class="op">=</span> <span class="id identifier rubyid_productions">productions</span><span class="period">.</span><span class="id identifier rubyid_reduce">reduce</span><span class="lparen">(</span><span class="int">0</span><span class="rparen">)</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_memo">memo</span><span class="comma">,</span> <span class="id identifier rubyid_choice">choice</span><span class="op">|</span>
      <span class="id identifier rubyid_memo">memo</span> <span class="op">+=</span> <span class="id identifier rubyid_choice">choice</span><span class="period">.</span><span class="id identifier rubyid_last">last</span>
    <span class="kw">end</span>

    <span class="kw">if</span> <span class="id identifier rubyid_productions">productions</span><span class="period">.</span><span class="id identifier rubyid_first">first</span><span class="period">.</span><span class="id identifier rubyid_last">last</span><span class="period">.</span><span class="id identifier rubyid_is_a?">is_a?</span><span class="lparen">(</span><span class="const">Float</span><span class="rparen">)</span>
      <span class="id identifier rubyid_raise">raise</span> <span class="const"><span class="object_link"><a href="" title="Calyx::Errors (module)">Errors</a></span></span><span class="op">::</span><span class="const"><span class="object_link"><a href="" title="Calyx::Errors::InvalidDefinition (class)">InvalidDefinition</a></span></span><span class="comma">,</span> <span class="tstring"><span class="tstring_beg">'</span><span class="tstring_content">Weights must sum to 1</span><span class="tstring_end">'</span></span> <span class="kw">if</span> <span class="id identifier rubyid_weights_sum">weights_sum</span> <span class="op">!=</span> <span class="float">1.0</span>
      <span class="id identifier rubyid_normalized_productions">normalized_productions</span> <span class="op">=</span> <span class="id identifier rubyid_productions">productions</span>
    <span class="kw">else</span>
      <span class="id identifier rubyid_normalized_productions">normalized_productions</span> <span class="op">=</span> <span class="id identifier rubyid_productions">productions</span><span class="period">.</span><span class="id identifier rubyid_map">map</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_choice">choice</span><span class="op">|</span>
        <span class="id identifier rubyid_weight">weight</span> <span class="op">=</span> <span class="id identifier rubyid_choice">choice</span><span class="period">.</span><span class="id identifier rubyid_last">last</span><span class="period">.</span><span class="id identifier rubyid_to_f">to_f</span> <span class="op">/</span> <span class="id identifier rubyid_weights_sum">weights_sum</span><span class="period">.</span><span class="id identifier rubyid_to_f">to_f</span> <span class="op">*</span> <span class="float">1.0</span>
        <span class="lbracket">[</span><span class="id identifier rubyid_choice">choice</span><span class="period">.</span><span class="id identifier rubyid_first">first</span><span class="comma">,</span> <span class="id identifier rubyid_weight">weight</span><span class="rbracket">]</span>
      <span class="kw">end</span>
    <span class="kw">end</span>
  <span class="kw">end</span>

  <span class="id identifier rubyid_choices">choices</span> <span class="op">=</span> <span class="id identifier rubyid_normalized_productions">normalized_productions</span><span class="period">.</span><span class="id identifier rubyid_map">map</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid_choice">choice</span><span class="comma">,</span> <span class="id identifier rubyid_weight">weight</span><span class="op">|</span>
    <span class="kw">if</span> <span class="id identifier rubyid_choice">choice</span><span class="period">.</span><span class="id identifier rubyid_is_a?">is_a?</span><span class="lparen">(</span><span class="const">String</span><span class="rparen">)</span>
      <span class="lbracket">[</span><span class="const"><span class="object_link"><a href="" title="Calyx::Production::Concat (class)">Concat</a></span></span><span class="period">.</span><span class="id identifier rubyid_parse"><span class="object_link"><a href="#parse-class_method" title="Calyx::Production::Concat.parse (method)">parse</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_choice">choice</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span><span class="comma">,</span> <span class="id identifier rubyid_weight">weight</span><span class="rbracket">]</span>
    <span class="kw">elsif</span> <span class="id identifier rubyid_choice">choice</span><span class="period">.</span><span class="id identifier rubyid_is_a?">is_a?</span><span class="lparen">(</span><span class="const">Symbol</span><span class="rparen">)</span>
      <span class="lbracket">[</span><span class="const"><span class="object_link"><a href="" title="Calyx::Production::NonTerminal (class)">NonTerminal</a></span></span><span class="period">.</span><span class="id identifier rubyid_new"><span class="object_link"><a href="#initialize-instance_method" title="Calyx::Production::NonTerminal#initialize (method)">new</a></span></span><span class="lparen">(</span><span class="id identifier rubyid_choice">choice</span><span class="comma">,</span> <span class="id identifier rubyid_registry">registry</span><span class="rparen">)</span><span class="comma">,</span> <span class="id identifier rubyid_weight">weight</span><span class="rbracket">]</span>
    <span class="kw">end</span>
  <span class="kw">end</span>

  <span class="kw">self</span><span class="period">.</span><span class="id identifier rubyid_new">new</span><span class="lparen">(</span><span class="id identifier rubyid_choices">choices</span><span class="rparen">)</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>


      <div class="method_details first">
  <h3 class="signature first" id="evaluate-instance_method">

    #<strong>evaluate</strong>(options)  ⇒ <tt>Array</tt>





</h3>
<div class="docstring">
  <div class="discussion">

<p>Evaluate the choice by randomly picking one of its possible options,
balanced according to the given weights.</p>

<p>The method for selecting weighted probabilities is based on a snippet of
code recommended in the Ruby standard library documentation.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">

    <li>

        <span class="name">options</span>


        <span class="type">(<tt><span class="object_link"><a href="" title="Calyx::Options (class)">Calyx::Options</a></span></tt>)</span>



    </li>

</ul>

<p class="tag_title">Returns:</p>
<ul class="return">

    <li>


        <span class="type">(<tt>Array</tt>)</span>



    </li>

</ul>

</div>
<table class="source_code">
  <tr>
    <td>
      <pre class="lines">


74
75
76
77
78
79
80</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/calyx/production/weighted_choices.rb', line 74</span>

<span class="kw">def</span> <span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span>
  <span class="id identifier rubyid_choice">choice</span> <span class="op">=</span> <span class="ivar">@collection</span><span class="period">.</span><span class="id identifier rubyid_max_by">max_by</span> <span class="kw">do</span> <span class="op">|</span><span class="id identifier rubyid__">_</span><span class="comma">,</span> <span class="id identifier rubyid_weight">weight</span><span class="op">|</span>
    <span class="id identifier rubyid_options">options</span><span class="period">.</span><span class="id identifier rubyid_rand">rand</span> <span class="op">**</span> <span class="lparen">(</span><span class="float">1.0</span> <span class="op">/</span> <span class="id identifier rubyid_weight">weight</span><span class="rparen">)</span>
  <span class="kw">end</span><span class="period">.</span><span class="id identifier rubyid_first">first</span>

  <span class="lbracket">[</span><span class="symbol">:weighted_choice</span><span class="comma">,</span> <span class="id identifier rubyid_choice">choice</span><span class="period">.</span><span class="id identifier rubyid_evaluate">evaluate</span><span class="lparen">(</span><span class="id identifier rubyid_options">options</span><span class="rparen">)</span><span class="rbracket">]</span>
<span class="kw">end</span></pre>
    </td>
  </tr>
</table>
</div>

  </div>


    </div>